"use strict";(self.webpackChunkramadhan_package_frontend=self.webpackChunkramadhan_package_frontend||[]).push([[654],{221:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(43),r=s(579);const n=function(e){let{startDate:t,months:s,paymentMethod:n,onConfirm:l}=e;const[o,i]=(0,a.useState)([]),d=(e,t)=>{const s=new Date(e);return s.setDate(s.getDate()+t),s},c=(()=>{const e=[],a=new Date(t);for(let t=0;t<s;t++){const s=new Date(a.getFullYear(),a.getMonth()+t,1),r={month:s,monthName:s.toLocaleString("default",{month:"long"}),year:s.getFullYear(),weeks:[],days:[]};if("weekly"===n){let e=new Date(s);for(;e.getMonth()===s.getMonth();)r.weeks.push(new Date(e)),e=d(e,7)}else if("daily"===n){const e=new Date(s.getFullYear(),s.getMonth()+1,0).getDate();for(let t=1;t<=e;t++)r.days.push(new Date(s.getFullYear(),s.getMonth(),t))}e.push(r)}return e})(),m=e=>{const t=e.toISOString().split("T")[0];i((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]))};return(0,r.jsxs)("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[c.map(((e,t)=>{let{month:s,monthName:a,year:n,weeks:l,days:i}=e;return(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-3",children:[a," ",n]}),l.length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Weekly Payments:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:l.map(((e,t)=>{const s=e.toISOString().split("T")[0];return(0,r.jsxs)("button",{onClick:()=>m(e),className:"px-3 py-1 rounded-md border text-sm ".concat(o.includes(s)?"bg-blue-600 text-white border-blue-700":"bg-white text-gray-800 border-gray-300 hover:bg-gray-100"),children:["Week ",t+1]},t)}))})]}),i.length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Daily Payments:"}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-1",children:i.map(((e,t)=>{const s=e.toISOString().split("T")[0];return(0,r.jsx)("button",{onClick:()=>m(e),className:"p-1 rounded-md text-xs text-center ".concat(o.includes(s)?"bg-blue-600 text-white":"bg-white text-gray-800 hover:bg-gray-100"),children:e.getDate()},t)}))})]})]},t)})),(0,r.jsxs)("button",{onClick:()=>{0!==o.length?(l(o),i([])):alert("Please select at least one payment date")},disabled:0===o.length,className:"mt-4 px-4 py-2 rounded-md text-white ".concat(o.length>0?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"),children:["Confirm ",o.length," Payment",1!==o.length?"s":""]})]})}},654:(e,t,s)=>{s.r(t),s.d(t,{default:()=>K});var a=s(8),r=s(43),n=s(216),l=s(265),o=(s(221),s(579));const i=e=>{let{activeTab:t,setActiveTab:s,children:a}=e;return(0,o.jsx)("div",{className:"w-full max-h-screen bg-gray-100",children:(0,o.jsxs)("div",{className:"w-full px-4 py-6",children:[(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Admin Dashboard"}),(0,o.jsx)("div",{className:"flex space-x-1 mt-2",children:["products","packages","customers","resellers","confirmations"].map((e=>(0,o.jsx)("button",{className:"px-4 py-2 text-sm font-medium rounded-t-lg ".concat(t===e?"bg-white text-blue-600 border-t-2 border-blue-500":"bg-gray-200 text-gray-600 hover:bg-gray-300"),onClick:()=>s(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),(0,o.jsx)("div",{className:"bg-white rounded-lg shadow p-6 w-full",children:a})]})})},d=e=>{let{newProduct:t,handleProductChange:s,createProduct:n,isLoading:l}=e;const[i,d]=(0,r.useState)({name:!1,price:!1,description:!1}),[c,m]=(0,r.useState)(!1);return(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 transition-all duration-300 hover:shadow-lg",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800 border-b pb-3",children:"Buat Produk Baru"}),c&&(0,o.jsxs)("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-lg flex items-center transition-opacity duration-300",children:[(0,o.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,o.jsx)("span",{children:"Produk berhasil dibuat!"})]}),(0,o.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await n(),m(!0),setTimeout((()=>m(!1)),2e3)}catch(t){console.error("Product creation failed:",t)}},className:"space-y-5",children:[(0,o.jsxs)("div",{className:"transition-all duration-200",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Produk"}),(0,o.jsx)("div",{className:"relative rounded-lg overflow-hidden transition-all duration-300 ".concat(i.name?"ring-2 ring-green-500":""),children:(0,o.jsx)("input",{type:"text",name:"name",value:t.name,onChange:s,onFocus:()=>d((0,a.A)((0,a.A)({},i),{},{name:!0})),onBlur:()=>d((0,a.A)((0,a.A)({},i),{},{name:!1})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none",placeholder:"Nama produk",required:!0})})]}),(0,o.jsxs)("div",{className:"transition-all duration-200",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Harga"}),(0,o.jsxs)("div",{className:"relative rounded-lg overflow-hidden transition-all duration-300 ".concat(i.price?"ring-2 ring-green-500":""),children:[(0,o.jsx)("div",{className:"absolute left-0 top-0 h-full flex items-center justify-center px-3 bg-gray-100 border-r border-gray-300",children:(0,o.jsx)("span",{className:"text-gray-500 font-medium",children:"Rp"})}),(0,o.jsx)("input",{type:"text",name:"price",value:0===t.price?"":t.price,onChange:e=>{const t=e.target.value.replace(/[^\d]/g,"");s({target:{name:"price",value:t}})},onFocus:()=>d((0,a.A)((0,a.A)({},i),{},{price:!0})),onBlur:()=>d((0,a.A)((0,a.A)({},i),{},{price:!1})),className:"w-full pl-12 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none ml-11",placeholder:"0",required:!0})]}),t.price>0&&(0,o.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Harga yang dimasukkan: Rp ",(u=t.price,u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))]})]}),(0,o.jsxs)("div",{className:"transition-all duration-200",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),(0,o.jsx)("div",{className:"relative rounded-lg overflow-hidden transition-all duration-300 ".concat(i.description?"ring-2 ring-green-500":""),children:(0,o.jsx)("textarea",{name:"description",value:t.description,onChange:s,onFocus:()=>d((0,a.A)((0,a.A)({},i),{},{description:!0})),onBlur:()=>d((0,a.A)((0,a.A)({},i),{},{description:!1})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none",rows:4,placeholder:"Deskripsi produk"})})]}),(0,o.jsx)("button",{type:"submit",disabled:l,className:"w-full mt-4 py-3 rounded-lg font-medium transition-all duration-300 transform ".concat(l?"bg-gray-400 text-white cursor-not-allowed opacity-70":"bg-green-600 text-white hover:bg-green-700 hover:shadow-md active:scale-98"),children:l?(0,o.jsxs)("div",{className:"flex items-center justify-center",children:[(0,o.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-2 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,o.jsx)("span",{children:"Sedang Membuat..."})]}):"Buat Produk"})]})]});var u},c=e=>{let{isOpen:t,title:s,children:a,onClose:r,size:n="md"}=e;if(!t)return null;return(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50 backdrop-blur-sm transition-opacity duration-300 p-4",children:(0,o.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl w-full ".concat({sm:"max-w-sm",md:"max-w-md",lg:"max-w-2xl",xl:"max-w-4xl"}[n]," transform transition-all duration-300 scale-100 animate-fadeIn max-h-[90vh] flex flex-col"),onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"flex justify-between items-center p-6 pb-4 border-b border-gray-100 flex-shrink-0",children:[(0,o.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:s}),(0,o.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,o.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,o.jsx)("div",{className:"text-sm text-gray-700 p-6 pt-4 overflow-y-auto flex-1",children:a})]})})},m=e=>{let{products:t,onProductSelect:s,selectedProductId:n,isLoading:l,error:i,onRefresh:d,onEdit:m,onDelete:u}=e;const[x,h]=(0,r.useState)(null),[p,g]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[f,v]=(0,r.useState)(null),[j,w]=(0,r.useState)({name:"",price:0,description:""}),[k,N]=(0,r.useState)(!1),[C,L]=(0,r.useState)(null),[A,_]=(0,r.useState)(null),M=()=>{g(!1),h(null),L(null)},P=()=>{b(!1),v(null)},S=e=>{const{name:t,value:s}=e.target;w((e=>(0,a.A)((0,a.A)({},e),{},{[t]:"price"===t?parseFloat(s)||0:s})))};return(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-100",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,o.jsxs)("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[(0,o.jsx)("span",{className:"inline-block w-1 h-6 bg-indigo-500 rounded-full mr-2"}),"Produk Tersedia"]}),(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[!l&&(0,o.jsxs)("span",{className:"bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-sm font-medium shadow-sm",children:[t.length," items"]}),(0,o.jsxs)("button",{onClick:d,disabled:l,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-1.5 rounded-lg text-sm transition flex items-center gap-1 disabled:opacity-50",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]})]}),A&&(0,o.jsxs)("div",{className:"bg-green-50 border-l-4 border-green-500 text-green-800 px-4 py-3 rounded-md mb-4 flex justify-between items-center shadow-sm",children:[(0,o.jsxs)("span",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),A]}),(0,o.jsx)("button",{onClick:()=>_(null),className:"text-sm font-bold hover:bg-green-100 rounded-full h-6 w-6 flex items-center justify-center",children:"\xd7"})]}),l?(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,o.jsx)("div",{className:"animate-spin h-10 w-10 border-4 border-indigo-500 border-t-transparent rounded-full"}),(0,o.jsx)("p",{className:"text-gray-500 mt-3",children:"Memuat produk..."})]}):i?(0,o.jsxs)("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-600 px-4 py-3 rounded-md shadow-sm",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i]}),(0,o.jsxs)("button",{onClick:d,className:"mt-2 ml-7 text-red-700 hover:text-red-800 underline font-medium flex items-center gap-1",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Coba Lagi"]})]}):0===t.length?(0,o.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-gray-400 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),(0,o.jsx)("p",{className:"mb-3 text-gray-500",children:"Belum ada produk ditambahkan."}),(0,o.jsxs)("button",{className:"inline-flex items-center text-indigo-600 hover:text-indigo-800 text-sm font-medium gap-1",onClick:d,children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]})]}):(0,o.jsx)("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-1 custom-scroll",children:t.map((e=>(0,o.jsx)("div",{className:"border rounded-lg p-4 transition-all duration-200 cursor-pointer hover:border-indigo-200 ".concat(n===e.id?"ring-2 ring-indigo-500 bg-indigo-50/50 shadow-md":"bg-white hover:shadow-md"),onClick:()=>null===s||void 0===s?void 0:s(e),children:(0,o.jsxs)("div",{className:"flex justify-between gap-4 items-start",children:[(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsx)("h3",{className:"font-semibold text-gray-800",children:e.name}),(0,o.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2 mt-1",children:e.description||"Tidak ada deskripsi"})]}),(0,o.jsxs)("div",{className:"text-right",children:[(0,o.jsxs)("p",{className:"text-indigo-600 font-medium bg-indigo-50 inline-block px-2 py-0.5 rounded-md mb-1",children:["Rp",e.price.toLocaleString("id-ID")]}),(0,o.jsxs)("p",{className:"text-xs text-gray-400 mb-2",children:["ID: ",e.id]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,o.jsxs)("button",{onClick:t=>{t.stopPropagation(),(e=>{h(e),w({name:e.name,price:e.price,description:e.description||""}),L(null),g(!0)})(e)},className:"bg-amber-100 text-amber-600 hover:bg-amber-200 hover:text-amber-700 px-3 py-1 rounded text-xs font-medium transition-colors flex items-center gap-1 shadow-sm border border-amber-200",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),(0,o.jsxs)("button",{onClick:t=>{var s;t.stopPropagation(),s=e.id,v(s),b(!0)},className:"bg-red-100 text-red-600 hover:bg-red-200 hover:text-red-700 px-3 py-1 rounded text-xs font-medium transition-colors flex items-center gap-1 shadow-sm border border-red-200",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]})]})},e.id)))}),(0,o.jsx)(c,{isOpen:p,title:"Edit Produk",onClose:M,children:(0,o.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),N(!0),L(null);try{await m((0,a.A)((0,a.A)({},x),j)),_("Produk berhasil diperbarui"),M()}catch(t){L("Gagal memperbarui produk: "+t.message)}finally{N(!1)}},className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Produk"}),(0,o.jsx)("input",{type:"text",name:"name",value:j.name,onChange:S,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Nama produk",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Harga"}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("span",{className:"absolute left-3 top-2",children:"Rp"}),(0,o.jsx)("input",{type:"number",name:"price",value:j.price,onChange:S,className:"w-full pl-8 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"0",min:"0",step:"any",required:!0})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),(0,o.jsx)("textarea",{name:"description",value:j.description,onChange:S,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",rows:3,placeholder:"Deskripsi produk"})]}),C&&(0,o.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-600 px-4 py-2 rounded",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),C]})}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,o.jsx)("button",{type:"button",onClick:M,className:"px-4 py-2 rounded-md bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors",children:"Batal"}),(0,o.jsx)("button",{type:"submit",disabled:k,className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 shadow-sm flex items-center gap-1",children:k?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"inline-block h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,o.jsx)("span",{children:"Menyimpan..."})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,o.jsx)("span",{children:"Simpan"})]})})]})]})}),(0,o.jsx)(c,{isOpen:y,title:"Konfirmasi Hapus",onClose:P,children:(0,o.jsxs)("div",{className:"p-1",children:[(0,o.jsxs)("div",{className:"flex items-center mb-4 text-red-600",children:[(0,o.jsx)("div",{className:"bg-red-100 p-2 rounded-full mr-3",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,o.jsx)("p",{className:"font-medium",children:"Apakah Anda yakin ingin menghapus produk ini?"})]}),(0,o.jsx)("p",{className:"text-gray-500 text-sm ml-11 mb-4",children:"Tindakan ini tidak dapat dibatalkan dan akan menghapus produk secara permanen."}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,o.jsx)("button",{onClick:P,className:"px-4 py-2 rounded-md bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors",children:"Batal"}),(0,o.jsxs)("button",{onClick:async()=>{if(f)try{await u(f),_("Produk berhasil dihapus")}catch(e){_("Gagal menghapus produk: "+e.message)}finally{P()}},className:"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700 shadow-sm flex items-center gap-1",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Hapus"]})]})]})})]})},u=e=>{let{newPackage:t,products:s,handlePackageChange:a,toggleProductInPackage:n,calculatePackageTotal:l,createPackage:i,isLoading:d}=e;const[c,m]=(0,r.useState)(""),[u,x]=(0,r.useState)(1),[h,p]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),b=(0,r.useMemo)((()=>s.filter((e=>e.name.toLowerCase().includes(c.toLowerCase())||e.price.toString().includes(c)))),[s,c]),f=Math.ceil(b.length/6),v=6*(u-1),j=v+6,w=b.slice(v,j),k=(()=>{const e=[];return t.name&&""!==t.name.trim()||e.push("Nama Paket"),t.description&&""!==t.description.trim()||e.push("Deskripsi Paket"),(!t.payment_amount||t.payment_amount<=0)&&e.push("Pembayaran Satu Kali"),(!t.payment_months||t.payment_months<=0)&&e.push("Periode (Bulan)"),t.productIds&&0!==t.productIds.length||e.push("Pilih minimal 1 produk"),e})(),N=0===k.length,C=e=>{e>=1&&e<=f&&e!==u&&(p(!0),setTimeout((()=>{x(e),p(!1)}),150))},L=e=>{"payment_amount"!==e.target.name&&a(e),g&&y(!1)},A=e=>{if(!g)return!1;switch(e){case"name":return!t.name||""===t.name.trim();case"description":return!t.description||""===t.description.trim();case"payment_amount":return!t.payment_amount||t.payment_amount<=0;case"payment_months":return!t.payment_months||t.payment_months<=0;case"products":return!t.productIds||0===t.productIds.length;default:return!1}};return(0,o.jsx)("form",{onSubmit:e=>{if(e.preventDefault(),!N)return y(!0),void window.scrollTo({top:0,behavior:"smooth"});y(!1),i()},className:"space-y-4",children:(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Buat Paket Baru"}),g&&!N&&(0,o.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-start",children:[(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.232 15.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Mohon lengkapi form berikut:"}),(0,o.jsx)("ul",{className:"mt-2 text-sm text-red-700 list-disc list-inside",children:k.map(((e,t)=>(0,o.jsx)("li",{children:e},t)))})]})]})}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nama Paket ",(0,o.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,o.jsx)("input",{type:"text",name:"name",value:t.name,onChange:L,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ".concat(A("name")?"border-red-300 bg-red-50":"border-gray-300"),placeholder:"Masukkan nama paket"}),A("name")&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-600",children:"Nama paket wajib diisi"})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deskripsi Paket ",(0,o.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,o.jsx)("textarea",{name:"description",value:t.description,onChange:L,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ".concat(A("description")?"border-red-300 bg-red-50":"border-gray-300"),rows:3,placeholder:"Masukkan deskripsi paket"}),A("description")&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-600",children:"Deskripsi paket wajib diisi"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipe Pembayaran"}),(0,o.jsxs)("select",{name:"payment_method",value:t.payment_method,onChange:L,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[(0,o.jsx)("option",{value:"daily",children:"Daily"}),(0,o.jsx)("option",{value:"weekly",children:"Weekly"}),(0,o.jsx)("option",{value:"monthly",children:"Monthly"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Pembayaran Satu Kali ",(0,o.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("span",{className:"absolute left-3 top-2 text-gray-500",children:"Rp"}),(0,o.jsx)("input",{type:"number",name:"payment_amount",value:t.payment_amount,onChange:e=>{const t={target:{name:"payment_amount",value:e.target.value}};a(t),g&&y(!1)},className:"w-full pl-8 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ".concat(A("payment_amount")?"border-red-300 bg-red-50":"border-gray-300"),placeholder:"0",min:"1"})]}),A("payment_amount")&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-600",children:"Jumlah pembayaran harus lebih dari 0"})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Periode (Bulan) ",(0,o.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,o.jsx)("input",{type:"number",name:"payment_months",value:t.payment_months||"",onChange:L,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ".concat(A("payment_months")?"border-red-300 bg-red-50":"border-gray-300"),placeholder:"0",min:"1",step:"1"}),A("payment_months")&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-600",children:"Periode harus lebih dari 0 bulan"})]})]}),(0,o.jsxs)("div",{className:"mt-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsxs)("h3",{className:"text-lg font-semibold",children:["Pilih Product ",(0,o.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,o.jsx)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:(0,o.jsxs)("span",{children:[b.length," products found"]})})]}),A("products")&&(0,o.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,o.jsx)("p",{className:"text-sm text-red-600",children:"Pilih minimal 1 produk untuk paket"})}),(0,o.jsx)("div",{className:"mb-4",children:(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("input",{type:"text",value:c,onChange:e=>{m(e.target.value),x(1)},placeholder:"Cari produk dari nama atau harga...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),(0,o.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 transition-all duration-150 ".concat(h?"opacity-50 transform scale-95":"opacity-100 transform scale-100"),children:w.map((e=>(0,o.jsx)("div",{onClick:()=>{n(e.id),g&&y(!1)},className:"p-3 border rounded-lg cursor-pointer transition-all duration-200 hover:shadow-md ".concat(t.productIds.includes(e.id)?"bg-blue-50 border-blue-300 shadow-sm":"bg-white hover:bg-gray-50 border-gray-200"),children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"checkbox",checked:t.productIds.includes(e.id),onChange:()=>{},className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["Rp",e.price.toLocaleString()]})]})]})},e.id)))}),0===b.length&&(0,o.jsxs)("div",{className:"text-center py-8",children:[(0,o.jsx)("div",{className:"text-gray-400 mb-2",children:(0,o.jsx)("svg",{className:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m13-8V4a1 1 0 00-1-1H7a1 1 0 00-1 1v1m12 0H6"})})}),(0,o.jsx)("p",{className:"text-gray-500",children:"Tidak ada produk yang ditemukan."})]})]}),f>1&&(0,o.jsxs)("div",{className:"flex items-center justify-between mt-4 px-2",children:[(0,o.jsxs)("div",{className:"text-sm text-gray-600",children:["Menampilkan ",v+1,"-",Math.min(j,b.length)," dari"," ",b.length," produk"]}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("button",{type:"button",onClick:()=>C(u-1),disabled:1===u,className:"p-2 rounded-lg border transition-all duration-200 ".concat(1===u?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-600 hover:bg-gray-50 hover:border-gray-400"),children:(0,o.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,o.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:f},((e,t)=>t+1)).filter((e=>1===e||e===f||e>=u-1&&e<=u+1)).map(((e,t,s)=>(0,o.jsxs)(r.Fragment,{children:[t>0&&s[t-1]!==e-1&&(0,o.jsx)("span",{className:"text-gray-400",children:"..."}),(0,o.jsx)("button",{type:"button",onClick:()=>C(e),className:"px-3 py-1 rounded-md text-sm transition-all duration-200 ".concat(u===e?"bg-indigo-600 text-white":"text-gray-600 hover:bg-gray-100"),children:e})]},e)))}),(0,o.jsx)("button",{type:"button",onClick:()=>C(u+1),disabled:u===f,className:"p-2 rounded-lg border transition-all duration-200 ".concat(u===f?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-600 hover:bg-gray-50 hover:border-gray-400"),children:(0,o.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})]}),(0,o.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center",children:[(0,o.jsx)("h3",{className:"font-semibold",children:"Detail Paket"}),(0,o.jsxs)("p",{className:"text-lg font-bold text-blue-700",children:["Total Harga Paket: Rp",l().toLocaleString()]})]}),(0,o.jsxs)("p",{className:"mt-2",children:[t.productIds.length," produk dipilih"]}),(0,o.jsxs)("p",{className:"mt-1",children:["Pembayaran: Rp",(t.payment_amount||0).toLocaleString()," ","per ",t.payment_method]})]}),!N&&(0,o.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{className:"h-5 w-5 text-yellow-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.232 15.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,o.jsx)("p",{className:"text-sm text-yellow-800",children:"Lengkapi semua field yang wajib diisi untuk membuat paket"})]})}),(0,o.jsx)("button",{type:"submit",disabled:d,className:"w-full py-3 rounded-lg font-medium text-white transition-all duration-200 ".concat(N&&!d?"bg-indigo-600 hover:bg-indigo-700 transform hover:scale-105":"bg-gray-400 cursor-not-allowed"),children:d?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"animate-spin inline-block mr-2",children:"\u21bb"}),"Membuat Paket..."]}):"Buat Paket ".concat(N?"":"(Lengkapi Form)")})]})]})})};var x=s(862);const h=e=>{let{packages:t=[],isLoading:s,error:n,onEdit:l,onEditProduct:i,onDelete:d,onRefresh:m}=e;const[u,h]=(0,r.useState)(10),[p,g]=(0,r.useState)(""),[y,b]=(0,r.useState)(null),[f,v]=(0,r.useState)(!1),[j,w]=(0,r.useState)(!1),[k,N]=(0,r.useState)(null),[C,L]=(0,r.useState)([]),[A,_]=(0,r.useState)(!1),[M,P]=(0,r.useState)(null),[S,D]=(0,r.useState)(""),[R,B]=(0,r.useState)(1),[I,E]=(0,r.useState)({name:"",description:"",payment_method:"daily",payment_amount:0,payment_months:0,productIds:[]}),[F,W]=(0,r.useState)(!1),[T,z]=(0,r.useState)(null),[H,O]=(0,r.useState)(null),[V,Y]=(0,r.useState)(!1),[U,q]=(0,r.useState)(null),[G,K]=(0,r.useState)({name:"",price:0,description:""}),J=t.filter((e=>e.name.toLowerCase().includes(p.toLowerCase())||e.description.toLowerCase().includes(p.toLowerCase()))),X=Math.ceil(J.length/u),Z=R*u,Q=Z-u,$=J.slice(Q,Z);(0,r.useEffect)((()=>{(async()=>{try{const e=await x.A.get("/products");L(e.data)}catch(n){console.error("Error fetching products:",n)}})(),B(1)}),[p,u]);const ee=C.filter((e=>e.name.toLowerCase().includes(S.toLowerCase()))).filter((e=>!I.productIds.includes(e.id))).slice(12*(R-1),12*R),te=e=>{q(e),K({name:e.name||"",price:e.price||0,description:e.description||""}),Y(!0)},se=()=>{Y(!1),q(null),K({name:"",price:0,description:""})},ae=e=>{const{name:t,value:s}=e.target;K((e=>(0,a.A)((0,a.A)({},e),{},{[t]:"price"===t?parseFloat(s)||0:s})))},re=()=>{v(!1),b(null),z(null)},ne=()=>{w(!1),N(null)},le=e=>{const{name:t,value:s}=e.target;E((e=>(0,a.A)((0,a.A)({},e),{},{[t]:"payment_amount"===t||"payment_months"===t?parseFloat(s)||0:s})))};return(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,o.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-white ",children:(0,o.jsxs)("div",{className:"grid-flow-row md:flex-row md:items-center md:justify-between gap-2",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Package Management"}),(0,o.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your subscription packages and pricing"})]}),(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[(0,o.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[(0,o.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,o.jsx)("input",{type:"text",placeholder:"Search packages...",value:p,onChange:e=>g(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),(0,o.jsxs)("div",{className:"relative min-w-[120px]",children:[(0,o.jsx)("select",{value:u,onChange:e=>h(Number(e.target.value)),className:"appearance-none block w-full bg-white border border-gray-300 rounded-lg px-3 py-2 pl-3 pr-8 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[5,10,25,50].map((e=>(0,o.jsxs)("option",{value:e,children:["Show ",e]},e)))}),(0,o.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),(0,o.jsxs)("button",{onClick:m,disabled:s,className:"flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-sm font-medium bg-white border border-gray-300 text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ".concat(s?"opacity-50 cursor-not-allowed":""),children:[s?(0,o.jsxs)("svg",{className:"animate-spin h-4 w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,o.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,o.jsx)("span",{children:"Refresh"})]})]})]})}),H&&(0,o.jsxs)("div",{className:"px-6 py-3 rounded-md mx-4 mt-4 flex items-center justify-between ".concat("success"===H.type?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"),children:[(0,o.jsxs)("div",{className:"flex items-center",children:["success"===H.type?(0,o.jsx)("svg",{className:"h-5 w-5 text-green-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):(0,o.jsx)("svg",{className:"h-5 w-5 text-red-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,o.jsx)("span",{className:"text-sm font-medium",children:H.message})]}),(0,o.jsx)("button",{onClick:()=>O(null),className:"text-gray-500 hover:text-gray-700 focus:outline-none",children:(0,o.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,o.jsx)("div",{className:"px-6 py-4",children:s?(0,o.jsx)("div",{className:"flex justify-center py-12",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})}):n?(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,o.jsx)("svg",{className:"h-12 w-12 text-red-500 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error loading packages"}),(0,o.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:n}),(0,o.jsx)("button",{onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Try Again"})]}):0===t.length?(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,o.jsx)("svg",{className:"h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No packages found"}),(0,o.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Create your first package to get started"}),(0,o.jsx)("button",{onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Refresh Data"})]}):(0,o.jsx)("div",{className:"space-y-4",children:$.map((e=>{var t,s,a,r,n,l,i;if(!e)return null;const d=(null===(t=e.products)||void 0===t?void 0:t.reduce(((e,t)=>e+((null===t||void 0===t?void 0:t.price)||0)),0))||0;return(0,o.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow duration-200",children:[(0,o.jsxs)("div",{className:"px-5 py-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.name||"Unnamed Package",(0,o.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("daily"===(null===(s=e.payment_method)||void 0===s?void 0:s.toLowerCase())?"bg-blue-100 text-blue-800":"weekly"===(null===(a=e.payment_method)||void 0===a?void 0:a.toLowerCase())?"bg-purple-100 text-purple-800":"monthly"===(null===(r=e.payment_method)||void 0===r?void 0:r.toLowerCase())?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:(null===(n=e.payment_method)||void 0===n?void 0:n.toLowerCase())||"unknown"})]}),e.description&&(0,o.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.description})]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsxs)("button",{onClick:()=>(e=>{var t;b(e),E({name:e.name||"",description:e.description||"",payment_method:(null===(t=e.payment_method)||void 0===t?void 0:t.toLowerCase())||"daily",payment_amount:e.payment_amount||0,payment_months:e.payment_months||0,productIds:e.products?e.products.map((e=>e.id)):[]}),z(null),v(!0)})(e),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,o.jsx)("svg",{className:"-ml-0.5 mr-1.5 h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),(0,o.jsxs)("button",{onClick:()=>{return t=e.id,N(t),void w(!0);var t},className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[(0,o.jsx)("svg",{className:"-ml-0.5 mr-1.5 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]}),(0,o.jsxs)("div",{className:"px-5 py-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,o.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,o.jsx)("h4",{className:"text-xs font-semibold text-blue-800 uppercase tracking-wider mb-1",children:"Payment"}),(0,o.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["Rp",(e.payment_amount||0).toLocaleString(),(0,o.jsxs)("span",{className:"text-sm font-normal text-gray-500 ml-1",children:["/ ",null===(l=e.payment_method)||void 0===l?void 0:l.toLowerCase()]})]})]}),(0,o.jsxs)("div",{className:"bg-purple-50 p-3 rounded-lg",children:[(0,o.jsx)("h4",{className:"text-xs font-semibold text-purple-800 uppercase tracking-wider mb-1",children:"Lama Pembayaran"}),(0,o.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[e.payment_months||0,(0,o.jsx)("span",{className:"text-sm font-normal text-gray-500 ml-1",children:"Bulan"})]})]}),(0,o.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,o.jsx)("h4",{className:"text-xs font-semibold text-green-800 uppercase tracking-wider mb-1",children:"Total Value"}),(0,o.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["Rp",d.toLocaleString()]})]})]}),(null===(i=e.products)||void 0===i?void 0:i.length)>0?(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Included Products"}),(0,o.jsx)("div",{className:"overflow-hidden border border-gray-200 rounded-lg",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,o.jsx)("th",{scope:"col",className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.products.map((e=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[e.name||"Unnamed Product",(0,o.jsx)("button",{onClick:t=>{t.stopPropagation(),te(e)},className:"text-blue-600 hover:text-blue-800 ml-2",title:"Edit product",children:(0,o.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})}),(0,o.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500 text-right",children:["Rp",(e.price||0).toLocaleString()]})]},e.id)))})]})})]}):(0,o.jsx)("div",{className:"mt-4 text-center py-4 bg-gray-50 rounded-lg",children:(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"No products included in this package"})})]})]},e.id)}))})}),J.length>u&&(0,o.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,o.jsxs)("div",{className:"text-sm text-gray-500",children:["Showing"," ",(0,o.jsx)("span",{className:"font-medium",children:Q+1})," to"," ",(0,o.jsx)("span",{className:"font-medium",children:Math.min(Z,J.length)})," ","of ",(0,o.jsx)("span",{className:"font-medium",children:J.length})," ","results"]}),(0,o.jsxs)("nav",{className:"flex items-center space-x-2",children:[(0,o.jsxs)("button",{onClick:()=>R>1&&B(R-1),disabled:1===R,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,o.jsx)("span",{className:"sr-only",children:"Previous"}),(0,o.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),Array.from({length:Math.min(5,X)}).map(((e,t)=>{let s;return s=X<=5||R<=3?t+1:R>=X-2?X-4+t:R-2+t,(0,o.jsx)("button",{onClick:()=>B(s),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(R===s?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:s},s)})),(0,o.jsxs)("button",{onClick:()=>R<X&&B(R+1),disabled:R===X,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,o.jsx)("span",{className:"sr-only",children:"Next"}),(0,o.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})]})}),(0,o.jsx)(c,{isOpen:V,title:"Edit Product",onClose:se,className:"max-w-lg overflow-y-auto",children:(0,o.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await i(U.id,G),O({type:"success",message:"Product updated successfully"}),se()}catch(t){O({type:"error",message:t.message||"Failed to update product"})}},className:"space-y-4 ",children:[(0,o.jsxs)("div",{className:"overflow-y-auto",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name"}),(0,o.jsx)("input",{type:"text",name:"name",value:G.name,onChange:ae,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Product name",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price"}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("span",{className:"absolute left-3 top-2",children:"Rp"}),(0,o.jsx)("input",{type:"number",name:"price",value:G.price,onChange:ae,className:"w-full pl-8 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"0",min:"0",step:"any",required:!0})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,o.jsx)("textarea",{name:"description",value:G.description,onChange:ae,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",rows:3,placeholder:"Product description"})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,o.jsx)("button",{type:"button",onClick:se,className:"px-4 py-2 rounded-md bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,o.jsxs)("button",{type:"submit",className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 shadow-sm flex items-center gap-1",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,o.jsx)("span",{children:"Save Product"})]})]})]})}),(0,o.jsxs)(c,{isOpen:f,title:"Edit Paket",onClose:re,children:[(0,o.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),W(!0),z(null);try{await l((0,a.A)((0,a.A)({},y),I)),O({type:"success",message:"Package updated successfully"}),re()}catch(t){z(t.message||"Failed to update package")}finally{W(!1)}},className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Paket"}),(0,o.jsx)("input",{type:"text",name:"name",value:I.name,onChange:le,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Nama paket",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),(0,o.jsx)("textarea",{name:"description",value:I.description,onChange:le,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",rows:3,placeholder:"Deskripsi paket"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Metode Pembayaran"}),(0,o.jsxs)("select",{name:"payment_method",value:I.payment_method,onChange:le,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[(0,o.jsx)("option",{value:"daily",children:"Harian"}),(0,o.jsx)("option",{value:"weekly",children:"Mingguan"}),(0,o.jsx)("option",{value:"monthly",children:"Bulanan"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Periode (Bulan)"}),(0,o.jsx)("input",{type:"number",name:"payment_months",value:I.payment_months,onChange:le,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"0",min:"0",step:"1",required:!0})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Harga"}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("span",{className:"absolute left-3 top-2",children:"Rp"}),(0,o.jsx)("input",{type:"number",name:"payment_amount",value:I.payment_amount,onChange:le,className:"w-full pl-8 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"0",min:"0",step:"any",required:!0})]})]}),(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,o.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Products in Package (",I.productIds.length,")"]}),(0,o.jsxs)("button",{type:"button",onClick:()=>_(!0),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,o.jsx)("svg",{className:"-ml-0.5 mr-1 h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Product"]})]}),I.productIds.length>0?(0,o.jsx)("div",{className:"max-h-64 overflow-y-auto pr-2",children:(0,o.jsx)("div",{className:"space-y-2",children:I.productIds.map((e=>{const t=C.find((t=>t.id===e));return t?(0,o.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-200 hover:shadow-sm transition-shadow",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[(0,o.jsx)("div",{className:"flex-shrink-0 h-10 w-10 bg-gray-200 rounded-full flex items-center justify-center",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),(0,o.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,o.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.name}),(0,o.jsxs)("p",{className:"text-xs text-gray-500",children:["Rp",t.price.toLocaleString()]})]})]}),(0,o.jsxs)("div",{className:"flex space-x-2 flex-shrink-0",children:[(0,o.jsx)("button",{type:"button",onClick:()=>te(t),className:"text-blue-500 hover:text-blue-700",title:"Edit product",children:(0,o.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,o.jsx)("button",{type:"button",onClick:()=>(e=>{E((t=>(0,a.A)((0,a.A)({},t),{},{productIds:t.productIds.filter((t=>t!==e))})))})(e),className:"text-red-500 hover:text-red-700",title:"Remove product",children:(0,o.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},e):null}))})}):(0,o.jsxs)("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[(0,o.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),(0,o.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No products added"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:'Click "Add Product" to include items in this package'})]})]}),T&&(0,o.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-600 px-4 py-2 rounded",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),T]})}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,o.jsx)("button",{type:"button",onClick:re,className:"px-4 py-2 rounded-md bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors",children:"Batal"}),(0,o.jsx)("button",{type:"submit",disabled:F,className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 shadow-sm flex items-center gap-1",children:F?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"inline-block h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,o.jsx)("span",{children:"Menyimpan..."})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,o.jsx)("span",{children:"Simpan"})]})})]})]}),(0,o.jsx)(c,{isOpen:A,title:"Add Product to Package",onClose:()=>{_(!1),D(""),B(1)},size:"xl",children:(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,o.jsx)("input",{type:"text",placeholder:"Search products...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:S,onChange:e=>{D(e.target.value),B(1)}})]}),(0,o.jsx)("div",{className:"border border-gray-200 rounded-xl",children:(0,o.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 p-4 max-h-96 overflow-y-auto",children:ee.map((e=>(0,o.jsx)("div",{onClick:()=>P(e.id),className:"p-3 border rounded-lg cursor-pointer transition ".concat(M===e.id?"bg-blue-50 border-blue-300":"bg-white hover:bg-gray-50"),children:(0,o.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,o.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full mb-2 flex items-center justify-center",children:(0,o.jsx)("svg",{className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),(0,o.jsx)("h4",{className:"font-medium text-sm truncate w-full",children:e.name}),(0,o.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Rp",e.price.toLocaleString()]})]})},e.id)))})}),X>1&&(0,o.jsxs)("div",{className:"flex justify-center items-center space-x-2",children:[(0,o.jsx)("button",{onClick:()=>B((e=>Math.max(e-1,1))),disabled:1===R,className:"p-1 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),Array.from({length:Math.min(5,X)}).map(((e,t)=>{let s;return s=X<=5||R<=3?t+1:R>=X-2?X-4+t:R-2+t,(0,o.jsx)("button",{onClick:()=>B(s),className:"w-8 h-8 rounded-full text-sm ".concat(R===s?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:s},s)})),(0,o.jsx)("button",{onClick:()=>B((e=>Math.min(e+1,X))),disabled:R===X,className:"p-1 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2 pt-2 border-t border-gray-200",children:[(0,o.jsx)("button",{type:"button",onClick:()=>{_(!1),D(""),B(1)},className:"px-4 py-2 rounded-md bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,o.jsx)("button",{type:"button",onClick:()=>{var e;M&&(e=M,I.productIds.includes(e)||E((t=>(0,a.A)((0,a.A)({},t),{},{productIds:[...t.productIds,e]}))),P(null),_(!1),D(""),B(1))},disabled:!M,className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 shadow-sm",children:"Add Product"})]})]})})]}),(0,o.jsxs)(c,{isOpen:j,title:"Confirm Deletion",onClose:ne,children:[(0,o.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,o.jsx)("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:(0,o.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,o.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,o.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delete package"}),(0,o.jsx)("div",{className:"mt-2",children:(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this package? This action cannot be undone."})})]})]}),(0,o.jsxs)("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[(0,o.jsx)("button",{type:"button",onClick:async()=>{if(k)try{await d(k),O({type:"success",message:"Package deleted successfully"})}catch(e){O({type:"error",message:e.message||"Failed to delete package"})}finally{ne()}},className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Delete"}),(0,o.jsx)("button",{type:"button",onClick:ne,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})};var p=s(986);const g=["children","variant","className","onClick"],y=["label","id","error"],b=["label","id","children"],f={Plus:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,o.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Edit:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,o.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),Delete:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,o.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),Key:()=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"})}),Eye:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,o.jsx)("circle",{cx:"12",cy:"12",r:"3"})]}),X:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),CheckCircle:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,o.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]}),AlertCircle:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,o.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,o.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})},v=e=>{let{message:t,type:s,onClose:a}=e;const n="success"===s?"bg-green-100":"bg-red-100",l="success"===s?"text-green-800":"text-red-800",i="success"===s?"border-green-400":"border-red-400",d="success"===s?f.CheckCircle:f.AlertCircle;return r.useEffect((()=>{const e=setTimeout((()=>{a&&a()}),4e3);return()=>clearTimeout(e)}),[a]),(0,o.jsxs)("div",{className:"fixed top-4 right-4 flex items-center p-4 mb-4 ".concat(n," ").concat(l," ").concat(i," border rounded-lg shadow-lg transition-all transform animate-fade-in z-50"),children:[(0,o.jsx)("div",{className:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8 mr-2",children:(0,o.jsx)(d,{})}),(0,o.jsx)("div",{className:"ml-2 text-sm font-medium",children:t}),(0,o.jsxs)("button",{type:"button",onClick:a,className:"ml-auto -mx-1.5 -my-1.5 rounded-lg p-1.5 inline-flex items-center justify-center h-8 w-8 hover:bg-gray-200",children:[(0,o.jsx)("span",{className:"sr-only",children:"Close"}),(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})]})]})},j=e=>{let{isOpen:t,onClose:s,title:a,children:r}=e;return t?(0,o.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:(0,o.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:s}),(0,o.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full animate-modal-in",children:(0,o.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,o.jsx)("div",{className:"sm:flex sm:items-start",children:(0,o.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center border-b pb-3",children:[(0,o.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:a}),(0,o.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:(0,o.jsx)(f.X,{})})]}),(0,o.jsx)("div",{className:"mt-4",children:r})]})})})})]})}):null},w=e=>{let{children:t,variant:s="primary",className:r="",onClick:n}=e,l=(0,p.A)(e,g);const i={primary:"bg-blue-600 hover:bg-blue-700 text-white border-transparent focus:ring-blue-500",secondary:"bg-white hover:bg-gray-50 text-gray-700 border-gray-300 focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white border-transparent focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white border-transparent focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white border-transparent focus:ring-yellow-500",info:"bg-purple-600 hover:bg-purple-700 text-white border-transparent focus:ring-purple-500"},d=i[s]||i.primary;return(0,o.jsx)("button",(0,a.A)((0,a.A)({className:"".concat("inline-flex justify-center items-center px-4 py-2 border font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200"," ").concat(d," ").concat(r),onClick:n},l),{},{children:t}))},k=e=>{let{label:t,id:s,error:r}=e,n=(0,p.A)(e,y);return(0,o.jsxs)("div",{className:"mb-4",children:[t&&(0,o.jsx)("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,o.jsx)("input",(0,a.A)({id:s,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 border ".concat(r?"border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500":"")},n)),r&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r})]})},N=e=>{let{label:t,id:s,children:r}=e,n=(0,p.A)(e,b);return(0,o.jsxs)("div",{className:"mb-4",children:[t&&(0,o.jsx)("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,o.jsx)("select",(0,a.A)((0,a.A)({id:s,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 border"},n),{},{children:r}))]})},C=e=>{let{children:t,variant:s="success"}=e;const a={success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"},r=a[s]||a.success;return(0,o.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(r),children:t})},L=e=>{let{customers:t,packages:s,onSelectCustomer:n,onRefresh:l}=e;const[i,d]=(0,r.useState)(null),[c,m]=(0,r.useState)({username:"",password:"",name:"",phone:"",role:"customer",package_id:null,package_start_date:""}),[u,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[L,A]=(0,r.useState)(null),[_,M]=(0,r.useState)(""),[P,S]=(0,r.useState)(null),[D,R]=(0,r.useState)({}),B=JSON.parse(localStorage.getItem("user")),I=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s={};return e.name.trim()||(s.name="Name is required"),t&&(e.username.trim()||(s.username="Username is required"),e.password.trim()?e.password.length<6&&(s.password="Password must be at least 6 characters"):s.password="Password is required"),s},E=e=>{const{name:t,value:s}=e.target;m((e=>(0,a.A)((0,a.A)({},e),{},{[t]:s})))},F=e=>{const{name:t,value:s}=e.target;m((e=>(0,a.A)((0,a.A)({},e),{},{[t]:s}))),D[t]&&R((e=>(0,a.A)((0,a.A)({},e),{},{[t]:null})))},W=e=>{if(!e)return"";const t=new Date(e),s=t.getFullYear(),a=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(r)},T=()=>{h(!1),g(!1),b(!1),d(null),A(null),M(""),R({})},z=e=>{window.confirm("Are you sure you want to delete this customer?")&&(async e=>{try{await x.A.delete("/users/customers/".concat(e)),S({message:"Customer deleted successfully",type:"success"}),l()}catch(a){var t,s;S({message:"Failed to delete customer: "+((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||a.message),type:"error"})}})(e)},H=e=>{const t=s.find((t=>t.id===e.package_id));return t?t.name:"No package"},O=t.filter((e=>!["ADMIN","RESELLER"].includes(e.role))),V=document.createElement("style");return V.innerText="\n    @keyframes fadeIn {\n      from { opacity: 0; }\n      to { opacity: 1; }\n    }\n    \n    @keyframes slideDown {\n      from { transform: translateY(-10px); opacity: 0; }\n      to { transform: translateY(0); opacity: 1; }\n    }\n    \n    @keyframes modalIn {\n      from { opacity: 0; transform: scale(0.95); }\n      to { opacity: 1; transform: scale(1); }\n    }\n    \n    .animate-fade-in {\n      animation: fadeIn 0.3s ease-in-out;\n    }\n    \n    .animate-slide-down {\n      animation: slideDown 0.3s ease-in-out;\n    }\n    \n    .animate-modal-in {\n      animation: modalIn 0.3s ease-out;\n    }\n  ",document.head.appendChild(V),(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[P&&(0,o.jsx)(v,{message:P.message,type:P.type,onClose:()=>{S(null)}}),(0,o.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Customer Management"}),(0,o.jsxs)(w,{onClick:()=>{m({username:"",password:"",name:"",phone:"",role:"customer",package_id:null}),R({}),h(!0)},className:"flex items-center gap-2",children:[(0,o.jsx)(f.Plus,{}),(0,o.jsx)("span",{children:"Add Customer"})]})]}),(0,o.jsxs)(j,{isOpen:u,onClose:T,title:"Create New Customer",children:[(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)(k,{label:"Name",id:"create-name",name:"name",placeholder:"Customer name",value:c.name,onChange:E,error:D.name}),(0,o.jsx)(k,{label:"Username",id:"create-username",name:"username",placeholder:"Login username",value:c.username,onChange:E,error:D.username}),(0,o.jsx)(k,{label:"Phone",id:"create-phone",name:"phone",type:"tel",placeholder:"Phone number",value:c.phone,onChange:E}),(0,o.jsx)(k,{label:"Password",id:"create-password",name:"password",type:"password",placeholder:"Set password",value:c.password,onChange:E,error:D.password}),s.length>0&&(0,o.jsxs)(N,{label:"Package",id:"create-package",name:"package_id",value:c.package_id||"",onChange:E,children:[(0,o.jsx)("option",{value:"",children:"Select a package"}),s.map((e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"create-package-start-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Package Start Date"}),(0,o.jsx)("input",{type:"date",id:"create-package-start-date",name:"package_start_date",value:c.package_start_date,onChange:F,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 border"})]})]}),(0,o.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,o.jsx)(w,{variant:"secondary",onClick:T,children:"Cancel"}),(0,o.jsx)(w,{variant:"success",onClick:async()=>{try{const e=I(c,!0);if(Object.keys(e).length>0)return void R(e);if(t.some((e=>e.username===c.username)))return void R({username:"Username already exists. Please choose another."});const s={username:c.username,password:c.password,name:c.name,phone:c.phone||null,role:"CUSTOMER",package_id:c.package_id||null,package_start_date:c.package_start_date||null};await x.A.post("/users/customers",s),S({message:"Customer created successfully",type:"success"}),T(),l()}catch(r){var e,s,a;console.error("Create customer error:",(null===(e=r.response)||void 0===e?void 0:e.data)||r),S({message:"Failed to create customer: "+((null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||r.message),type:"error"})}},children:"Create Customer"})]})]}),(0,o.jsxs)(j,{isOpen:p,onClose:T,title:"Edit Customer",children:[(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)(k,{label:"Name",id:"edit-name",name:"name",placeholder:"Customer name",value:c.name,onChange:E,error:D.name}),(0,o.jsx)(k,{label:"Username",id:"edit-username",name:"username",placeholder:"Login username",value:c.username,onChange:E,disabled:!0}),(0,o.jsx)(k,{label:"Phone",id:"edit-phone",name:"phone",placeholder:"Phone number",value:c.phone,onChange:E}),s.length>0&&(0,o.jsxs)(N,{label:"Package",id:"edit-package",name:"package_id",value:c.package_id||"",onChange:E,children:[(0,o.jsx)("option",{value:"",children:"Select a package"}),s.map((e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"edit-package-start-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Package Start Date"}),(0,o.jsx)("input",{type:"date",id:"edit-package-start-date",name:"package_start_date",value:c.package_start_date,onChange:F,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 border"})]})]}),(0,o.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,o.jsx)(w,{variant:"secondary",onClick:T,children:"Cancel"}),(0,o.jsx)(w,{variant:"warning",onClick:async()=>{try{if(!i)return;const e=I(c,!1);if(Object.keys(e).length>0)return void R(e);const t=(0,a.A)((0,a.A)({},c),{},{package_start_date:c.package_start_date||null});await x.A.put("/users/customers/".concat(i.id),t),S({message:"Customer updated successfully",type:"success"}),T(),l()}catch(s){var e,t;S({message:"Failed to update customer: "+((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||s.message),type:"error"})}},children:"Update Customer"})]})]}),(0,o.jsxs)(j,{isOpen:y,onClose:T,title:"Reset Password",children:[(0,o.jsx)(k,{label:"New Password",id:"reset-password",type:"password",placeholder:"Enter new password",value:_,onChange:e=>M(e.target.value),error:D.password}),(0,o.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,o.jsx)(w,{variant:"secondary",onClick:T,children:"Cancel"}),(0,o.jsx)(w,{variant:"info",onClick:async()=>{if(_)if(_.length<6)R({password:"Password must be at least 6 characters"});else try{await x.A.post("/users/customers/".concat(L,"/reset-password"),{newPassword:_}),S({message:"Password reset successfully",type:"success"}),T(),console.log("ID yang dikirim:",L)}catch(s){var e,t;S({message:"Failed to reset password: "+((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||s.message),type:"error"})}else R({password:"New password is required"})},children:"Reset Password"})]})]}),(0,o.jsx)("div",{className:"mt-4 overflow-hidden shadow ring-1 ring-black ring-opacity-5 rounded-lg",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer Nama"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paket"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===O.length?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"4",className:"px-6 py-4 text-sm text-gray-500 text-center",children:"No customers found"})}):O.map((e=>(0,o.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center text-white font-medium",children:e.username.charAt(0).toUpperCase()}),(0,o.jsxs)("div",{className:"ml-4",children:[(0,o.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["Username:",e.username]}),(0,o.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["Nama:",e.name]}),e.phone&&(0,o.jsxs)("div",{className:"text-xs text-gray-500",children:["No hp:",e.phone]})]})]})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-900",children:H(e)})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)(C,{variant:"success",children:"Active"})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,o.jsxs)("div",{className:"flex space-x-3",children:[(0,o.jsx)("button",{onClick:()=>n(e),className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",title:"View Payments",children:(0,o.jsx)(f.Eye,{})}),e.id===(null===B||void 0===B?void 0:B.id)?(0,o.jsx)("span",{className:"text-gray-400 cursor-not-allowed flex items-center gap-1",title:"You cannot edit your own account here",children:(0,o.jsx)(f.Edit,{})}):(0,o.jsx)("button",{onClick:()=>(e=>{e.id!==(null===B||void 0===B?void 0:B.id)&&(d(e),m({username:e.username||"",name:e.name||"",phone:e.phone||"",password:"",role:e.role||"customer",package_id:e.package_id||null,package_start_date:W(e.package_start_date)}),R({}),g(!0))})(e),className:"text-yellow-600 hover:text-yellow-900 flex items-center gap-1",title:"Edit Customer",children:(0,o.jsx)(f.Edit,{})}),(0,o.jsx)("button",{onClick:()=>{return t=e.id,A(t),M(""),b(!0),void R({});var t},className:"text-purple-600 hover:text-purple-900 flex items-center gap-1",title:"Reset Password",children:(0,o.jsx)(f.Key,{})}),(0,o.jsx)("button",{onClick:()=>z(e.id),className:"text-red-600 hover:text-red-900 flex items-center gap-1",title:"Delete Customer",children:(0,o.jsx)(f.Delete,{})})]})})]},e.id)))})]})})]})},A=["children","variant","className","onClick"],_=["label","id","error"],M={Plus:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,o.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Edit:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,o.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),Delete:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,o.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),Key:()=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"})}),Eye:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,o.jsx)("circle",{cx:"12",cy:"12",r:"3"})]}),X:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),CheckCircle:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,o.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]}),AlertCircle:()=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,o.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,o.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})},P=e=>{let{message:t,type:s,onClose:a}=e;const n="success"===s?"bg-green-100":"bg-red-100",l="success"===s?"text-green-800":"text-red-800",i="success"===s?"border-green-400":"border-red-400",d="success"===s?M.CheckCircle:M.AlertCircle;return r.useEffect((()=>{const e=setTimeout((()=>{a&&a()}),4e3);return()=>clearTimeout(e)}),[a]),(0,o.jsxs)("div",{className:"fixed top-4 right-4 flex items-center p-4 mb-4 ".concat(n," ").concat(l," ").concat(i," border rounded-lg shadow-lg transition-all transform animate-fade-in z-50"),children:[(0,o.jsx)("div",{className:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8 mr-2",children:(0,o.jsx)(d,{})}),(0,o.jsx)("div",{className:"ml-2 text-sm font-medium",children:t}),(0,o.jsxs)("button",{type:"button",onClick:a,className:"ml-auto -mx-1.5 -my-1.5 rounded-lg p-1.5 inline-flex items-center justify-center h-8 w-8 hover:bg-gray-200",children:[(0,o.jsx)("span",{className:"sr-only",children:"Close"}),(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,o.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})]})]})},S=e=>{let{isOpen:t,onClose:s,title:a,children:r}=e;return t?(0,o.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:(0,o.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:s}),(0,o.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full animate-modal-in",children:(0,o.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,o.jsx)("div",{className:"sm:flex sm:items-start",children:(0,o.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center border-b pb-3",children:[(0,o.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:a}),(0,o.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:(0,o.jsx)(M.X,{})})]}),(0,o.jsx)("div",{className:"mt-4",children:r})]})})})})]})}):null},D=e=>{let{children:t,variant:s="primary",className:r="",onClick:n}=e,l=(0,p.A)(e,A);const i={primary:"bg-blue-600 hover:bg-blue-700 text-white border-transparent focus:ring-blue-500",secondary:"bg-white hover:bg-gray-50 text-gray-700 border-gray-300 focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white border-transparent focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white border-transparent focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white border-transparent focus:ring-yellow-500",info:"bg-purple-600 hover:bg-purple-700 text-white border-transparent focus:ring-purple-500"},d=i[s]||i.primary;return(0,o.jsx)("button",(0,a.A)((0,a.A)({className:"".concat("inline-flex justify-center items-center px-4 py-2 border font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200"," ").concat(d," ").concat(r),onClick:n},l),{},{children:t}))},R=e=>{let{label:t,id:s,error:r}=e,n=(0,p.A)(e,_);return(0,o.jsxs)("div",{className:"mb-4",children:[t&&(0,o.jsx)("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,o.jsx)("input",(0,a.A)({id:s,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md p-2 border ".concat(r?"border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500":"")},n)),r&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r})]})},B=e=>{let{children:t,variant:s="success"}=e;const a={success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"},r=a[s]||a.success;return(0,o.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(r),children:t})},I=e=>{let{resellers:t=[],customers:s=[],packages:l=[],onCreateReseller:i,onUpdateReseller:d,onDeleteReseller:c,isLoading:m,error:u}=e;const[h,p]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[b,f]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),[w,k]=(0,r.useState)(""),[N,C]=(0,r.useState)(null),[L,A]=(0,r.useState)({}),_=(0,n.Zp)(),[I,E]=(0,r.useState)({name:"",username:"",phone:"",password:""}),[F,W]=(0,r.useState)(null),T=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s={};return e.name.trim()||(s.name="Name is required"),e.phone.trim()||(s.phone="Phone is required"),t&&(e.username.trim()||(s.username="Username is required"),e.password.trim()?e.password.length<6&&(s.password="Password must be at least 6 characters"):s.password="Password is required"),s},z=e=>{const{name:t,value:s}=e.target;E((e=>(0,a.A)((0,a.A)({},e),{},{[t]:s}))),L[t]&&A((e=>(0,a.A)((0,a.A)({},e),{},{[t]:null})))},H=()=>{p(!1),y(!1),f(!1),W(null),j(null),k(""),A({})},O=e=>{window.confirm("Are you sure you want to delete this reseller?")&&(async e=>{try{await c(e),C({message:"Reseller deleted successfully",type:"success"})}catch(u){C({message:"Failed to delete reseller: "+(u.message||""),type:"error"})}})(e)},V=document.createElement("style");return V.innerText="\n    @keyframes fadeIn {\n      from { opacity: 0; }\n      to { opacity: 1; }\n    }\n    \n    @keyframes slideDown {\n      from { transform: translateY(-10px); opacity: 0; }\n      to { transform: translateY(0); opacity: 1; }\n    }\n    \n    @keyframes modalIn {\n      from { opacity: 0; transform: scale(0.95); }\n      to { opacity: 1; transform: scale(1); }\n    }\n    \n    .animate-fade-in {\n      animation: fadeIn 0.3s ease-in-out;\n    }\n    \n    .animate-slide-down {\n      animation: slideDown 0.3s ease-in-out;\n    }\n    \n    .animate-modal-in {\n      animation: modalIn 0.3s ease-out;\n    }\n  ",document.head.appendChild(V),(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[N&&(0,o.jsx)(P,{message:N.message,type:N.type,onClose:()=>{C(null)}}),(0,o.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Reseller Management"}),(0,o.jsxs)(D,{onClick:()=>{E({name:"",username:"",phone:"",password:""}),A({}),p(!0)},className:"flex items-center gap-2",children:[(0,o.jsx)(M.Plus,{}),(0,o.jsx)("span",{children:"Add Reseller"})]})]}),(0,o.jsxs)(S,{isOpen:h,onClose:H,title:"Create New Reseller",children:[(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)(R,{label:"Name",id:"create-name",name:"name",placeholder:"Reseller name",value:I.name,onChange:z,error:L.name}),(0,o.jsx)(R,{label:"Username",id:"create-username",name:"username",placeholder:"Login username",value:I.username,onChange:z,error:L.username}),(0,o.jsx)(R,{label:"Phone",id:"create-phone",name:"phone",type:"tel",placeholder:"Phone number",value:I.phone,onChange:z,error:L.phone}),(0,o.jsx)(R,{label:"Password",id:"create-password",name:"password",type:"password",placeholder:"Set password",value:I.password,onChange:z,error:L.password})]}),(0,o.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,o.jsx)(D,{variant:"secondary",onClick:H,children:"Cancel"}),(0,o.jsx)(D,{variant:"success",onClick:async()=>{try{const e=T(I,!0);if(Object.keys(e).length>0)return void A(e);if(t.some((e=>e.username===I.username)))return void A({username:"Username already exists. Please choose another."});if(t.some((e=>e.name===I.name)))return void A({name:"Reseller name already exists. Please choose another."});await i((0,a.A)((0,a.A)({},I),{},{role:"RESELLER"})),C({message:"Reseller created successfully",type:"success"}),H()}catch(u){C({message:"Failed to create reseller: "+(u.message||""),type:"error"})}},children:"Create Reseller"})]})]}),(0,o.jsxs)(S,{isOpen:g,onClose:H,title:"Edit Reseller",children:[(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)(R,{label:"Name",id:"edit-name",name:"name",placeholder:"Reseller name",value:I.name,onChange:z,error:L.name}),(0,o.jsx)(R,{label:"Username",id:"edit-username",name:"username",placeholder:"Login username",value:I.username,onChange:z,disabled:!0}),(0,o.jsx)(R,{label:"Phone",id:"edit-phone",name:"phone",placeholder:"Phone number",value:I.phone,onChange:z,error:L.phone}),(0,o.jsx)(R,{label:"New Password (Leave blank to keep current)",id:"edit-password",name:"password",type:"password",placeholder:"New password",value:I.password,onChange:z,error:L.password})]}),(0,o.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,o.jsx)(D,{variant:"secondary",onClick:H,children:"Cancel"}),(0,o.jsx)(D,{variant:"warning",onClick:async()=>{try{if(!F)return;const e=T(I,!1);if(Object.keys(e).length>0)return void A(e);const t=(0,a.A)({name:I.name,phone:I.phone},I.password&&{password:I.password});await d(F.id,t),C({message:"Reseller updated successfully",type:"success"}),H()}catch(u){C({message:"Failed to update reseller: "+(u.message||""),type:"error"})}},children:"Update Reseller"})]})]}),(0,o.jsxs)(S,{isOpen:b,onClose:H,title:"Reset Password",children:[(0,o.jsx)(R,{label:"New Password",id:"reset-password",type:"password",placeholder:"Enter new password",value:w,onChange:e=>k(e.target.value),error:L.password}),(0,o.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,o.jsx)(D,{variant:"secondary",onClick:H,children:"Cancel"}),(0,o.jsx)(D,{variant:"info",onClick:async()=>{if(w)if(w.length<6)A({password:"Password must be at least 6 characters"});else try{await x.A.post("/resellers/".concat(v,"/reset-password"),{newPassword:w}),C({message:"Password reset successfully",type:"success"}),H()}catch(u){C({message:"Failed to reset password: "+(u.message||""),type:"error"})}else A({password:"New password is required"})},children:"Reset Password"})]})]}),(0,o.jsx)("div",{className:"mt-4 overflow-hidden shadow ring-1 ring-black ring-opacity-5 rounded-lg",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reseller"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customers"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===t.length?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"5",className:"px-6 py-4 text-sm text-gray-500 text-center",children:"No resellers found"})}):t.map((e=>(0,o.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center text-white font-medium",children:e.name.charAt(0).toUpperCase()}),(0,o.jsxs)("div",{className:"ml-4",children:[(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,o.jsxs)("div",{className:"text-xs text-gray-500",children:["Username: ",e.username]})]})]})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.phone}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.filter((t=>t.reseller_id===e.id)).length}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)(B,{variant:"success",children:"Active"})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,o.jsxs)("div",{className:"flex space-x-3",children:[(0,o.jsx)("button",{onClick:()=>{return t=e.id,void _("/admin/resellers/".concat(t,"/customers"));var t},className:"text-blue-600 hover:text-blue-900 flex items-center gap-1",title:"View Customers",children:(0,o.jsx)(M.Eye,{})}),(0,o.jsx)("button",{onClick:()=>(e=>{W(e),E({name:e.name||"",username:e.username||"",phone:e.phone||"",password:""}),A({}),y(!0)})(e),className:"text-yellow-600 hover:text-yellow-900 flex items-center gap-1",title:"Edit Reseller",children:(0,o.jsx)(M.Edit,{})}),(0,o.jsx)("button",{onClick:()=>{return t=e.id,j(t),k(""),f(!0),void A({});var t},className:"text-purple-600 hover:text-purple-900 flex items-center gap-1",title:"Reset Password",children:(0,o.jsx)(M.Key,{})}),(0,o.jsx)("button",{onClick:()=>O(e.id),className:"text-red-600 hover:text-red-900 flex items-center gap-1",title:"Delete Reseller",children:(0,o.jsx)(M.Delete,{})})]})})]},e.id)))})]})})]})};var E=s(780),F=s(819),W=s(128),T=s(255),z=s(10),H=s(278),O=s(431),V=s(82),Y=s(238);const U=e=>{var t;let{customer:s,packages:a,onClose:n,onSubmit:i=()=>{}}=e;const[d,c]=(0,r.useState)(0),[m,u]=(0,r.useState)(new Date),[h,p]=(0,r.useState)([]),[g,y]=(0,r.useState)([]),[b,f]=(0,r.useState)(!1),[v,j]=(0,r.useState)(0),[w,k]=(0,r.useState)(!1),N=null===a||void 0===a?void 0:a.find((e=>e.id===s.package_id));(0,r.useEffect)((()=>{(async()=>{try{const e=await x.A.get("/payments/paid-dates/".concat(s.id));e.data&&Array.isArray(e.data.paid_dates)&&y(e.data.paid_dates)}catch(e){console.error("Failed to fetch paid dates:",e)}})()}),[s.id]),(0,r.useEffect)((()=>{N&&C()}),[h,N]);const C=()=>{if(!N)return;let e=0;const t=N.payment_amount;switch(N.payment_method){case"DAILY":default:e=t*h.length;break;case"WEEKLY":e=7*t*Math.ceil(h.length/7);break;case"MONTHLY":e=30*t*Math.ceil(h.length/30)}c(e)},L=e=>{switch(e){case"DAILY":return"Harian";case"WEEKLY":return"Mingguan";case"MONTHLY":return"Bulanan";default:return e}},A=s.package_start_date?(0,E.A)(new Date(s.package_start_date)):(0,E.A)(new Date),_=(null===N||void 0===N?void 0:N.payment_months)||1,M=Array.from({length:_},((e,t)=>(0,F.A)(A,t)))[v],P=(0,W.A)(M),S=(0,T.A)(M),D=((0,E.A)(P),(0,T.A)(S),P.getDay()),R=Array.from({length:D},((e,t)=>{const s=new Date(P);return s.setDate(s.getDate()-(D-t)),s})),B=(0,z.A)({start:P,end:S}),I=S.getDay(),U=[...R,...B,...Array.from({length:6-I},((e,t)=>{const s=new Date(S);return s.setDate(s.getDate()+(t+1)),s}))],q=e=>{const t=v+e;t>=0&&t<_&&j(t)};return(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,o.jsx)("h2",{className:"text-xl font-bold",children:"Konfirmasi Pembayaran"}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("button",{onClick:async()=>{k(!0);try{var e,t;const a=(await x.A.get("/payments/history/".concat(s.id))).data||[],r=[];r.push(["RIWAYAT PEMBAYARAN"]),r.push([""]),r.push(["Nama Pelanggan:",s.name]),r.push(["Paket:",(null===N||void 0===N?void 0:N.name)||"Tidak diketahui"]),r.push(["Metode Pembayaran:",L(null===N||void 0===N?void 0:N.payment_method)]),r.push(["Tarif:","Rp ".concat((null===N||void 0===N||null===(e=N.payment_amount)||void 0===e?void 0:e.toLocaleString("id-ID"))||0," per ").concat(null===(t=L(null===N||void 0===N?void 0:N.payment_method))||void 0===t?void 0:t.toLowerCase())]),r.push(["Tanggal Mulai Paket:",s.package_start_date?(0,l.A)(new Date(s.package_start_date),"dd MMMM yyyy",{locale:V.A}):"Tidak diketahui"]),r.push([""]),r.push(["DAFTAR TANGGAL KONFIRMASI:"]),r.push(["Tanggal","Status","Jumlah Pembayaran","Tanggal Pembayaran"]),g.length>0&&g.forEach((e=>{var t;const s=a.find((t=>t.selected_dates&&t.selected_dates.includes(e)));r.push([(0,l.A)(new Date(e),"dd MMMM yyyy",{locale:V.A}),"Sudah Dibayar",s?"Rp ".concat((null===(t=s.amount)||void 0===t?void 0:t.toLocaleString("id-ID"))||0):"",s&&s.payment_date?(0,l.A)(new Date(s.payment_date),"dd MMMM yyyy",{locale:V.A}):""])})),h.length>0&&(r.push([""]),r.push(["TANGGAL YANG DIPILIH SAAT INI:"]),h.forEach((e=>{r.push([(0,l.A)(new Date(e),"dd MMMM yyyy",{locale:V.A}),"Belum Dikonfirmasi","Rp ".concat(d.toLocaleString("id-ID")),(0,l.A)(m,"dd MMMM yyyy",{locale:V.A})])})));const n=Y.Wp.book_new(),o=Y.Wp.aoa_to_sheet(r),i=[{wch:20},{wch:20},{wch:20},{wch:20}];o["!cols"]=i,Y.Wp.book_append_sheet(n,o,"Riwayat Pembayaran");const c="Riwayat_Pembayaran_".concat(s.name.replace(/\s+/g,"_"),"_").concat((0,l.A)(new Date,"ddMMyyyy"),".xlsx");Y._h(n,c)}catch(a){console.error("Export failed:",a),alert("Gagal mengekspor data. Silakan coba lagi.")}finally{k(!1)}},disabled:w,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200 text-sm flex items-center space-x-2",children:w?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,o.jsx)("span",{children:"Mengekspor..."})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,o.jsx)("span",{children:"Export Excel"})]})}),(0,o.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-800 text-2xl font-bold",children:"\xd7"})]})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsxs)("h3",{className:"font-medium mb-2",children:["Pelanggan: ",s.name]}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["Paket: ",null===N||void 0===N?void 0:N.name," (Rp"," ",null===N||void 0===N?void 0:N.payment_amount.toLocaleString("id-ID")," per"," ",null===(t=L(null===N||void 0===N?void 0:N.payment_method))||void 0===t?void 0:t.toLowerCase(),null!==N&&void 0!==N&&N.payment_months?" selama ".concat(N.payment_months," bulan"):"",")"]})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block font-medium mb-2",children:"Tanggal Pembayaran:"}),(0,o.jsx)("input",{type:"date",value:(0,l.A)(m,"yyyy-MM-dd"),onChange:e=>u(new Date(e.target.value)),className:"border border-gray-300 rounded-md px-3 py-2 w-full"})]}),(0,o.jsx)("div",{className:"mb-4",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("button",{onClick:()=>q(-1),disabled:0===v,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,o.jsx)("h3",{className:"text-lg font-semibold",children:(0,l.A)(M,"MMMM yyyy",{locale:V.A})}),(0,o.jsx)("button",{onClick:()=>q(1),disabled:v===_-1,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("h3",{className:"font-medium mb-2",children:"Pilih Tanggal untuk Konfirmasi Pembayaran:"}),(0,o.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Min","Sen","Sel","Rab","Kam","Jum","Sab"].map((e=>(0,o.jsx)("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:e},e)))}),(0,o.jsx)("div",{className:"grid grid-cols-7 gap-1",children:U.map(((e,t)=>{const s=(0,l.A)(e,"yyyy-MM-dd"),a=g.includes(s),r=h.includes(s),n=(0,O.A)(e,M),i=(e=>{const t=(0,F.A)(A,_);return!(0,H.A)(e,A)&&(0,H.A)(e,t)})(e),d=n&&i&&!a;return(0,o.jsxs)("button",{onClick:()=>d&&(e=>{g.includes(e)||p((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(s),disabled:!d,className:"\n\t\t\t\t\t\t\t\t\t\tp-2 text-center rounded text-sm transition-all duration-200 min-h-[40px] relative\n\t\t\t\t\t\t\t\t\t\t".concat(n&&i?a?"bg-green-100 text-green-800 cursor-not-allowed":r?"bg-indigo-600 text-white shadow-md transform scale-105":"bg-gray-100 text-gray-800 hover:bg-gray-200 hover:shadow-sm":"bg-gray-50 text-gray-300 cursor-not-allowed","\n\t\t\t\t\t\t\t\t\t"),children:[(0,o.jsx)("span",{className:"block",children:(0,l.A)(e,"d")}),a&&(0,o.jsx)("span",{className:"block text-xs mt-1 font-medium",children:"Lunas"})]},t)}))})]}),(0,o.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[(0,o.jsx)("h3",{className:"font-medium mb-2",children:"Ringkasan Pembayaran:"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-sm text-gray-600",children:"Tanggal Dipilih:"}),(0,o.jsx)("p",{className:"font-semibold",children:h.length})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-sm text-gray-600",children:"Metode Pembayaran:"}),(0,o.jsx)("p",{className:"font-semibold",children:L(null===N||void 0===N?void 0:N.payment_method)})]})]}),(0,o.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,o.jsxs)("p",{className:"text-lg font-bold text-indigo-600",children:["Total Jumlah: Rp ",d.toLocaleString("id-ID")]})})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,o.jsx)("button",{onClick:n,className:"px-6 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors duration-200",children:"Batal"}),(0,o.jsx)("button",{onClick:async()=>{if("function"===typeof i){f(!0);try{const e={customerId:s.id,packageId:s.package_id,amount:d,paymentDate:m.toISOString(),selectedDates:h,paymentMethod:(null===N||void 0===N?void 0:N.payment_method)||"DAILY"};await i(e),n()}catch(e){console.error("Payment submission failed:",e)}finally{f(!1)}}else console.error("onSubmit is not a function")},disabled:0===h.length||b,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200",children:b?"Memproses...":"Konfirmasi Pembayaran"})]})]})})},q=e=>{let{customers:t,isOpen:s,onClose:a,onConfirm:n}=e;const[l,i]=(0,r.useState)(""),[d,m]=(0,r.useState)(""),[u,x]=(0,r.useState)([]);(0,r.useEffect)((()=>{s||(i(""),m(""),x([]))}),[s]);return(0,o.jsx)(c,{isOpen:s,onClose:a,title:"Export All - Filter Options",children:(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block font-medium mb-1",children:"Start Date"}),(0,o.jsx)("input",{type:"date",value:l,onChange:e=>i(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block font-medium mb-1",children:"End Date"}),(0,o.jsx)("input",{type:"date",value:d,onChange:e=>m(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block font-medium mb-1",children:"Select Users"}),(0,o.jsx)("div",{className:"max-h-40 overflow-y-auto border border-gray-300 rounded p-2",children:t.map((e=>(0,o.jsxs)("div",{className:"flex items-center mb-1",children:[(0,o.jsx)("input",{type:"checkbox",id:"user-".concat(e.id),checked:u.includes(e.id),onChange:()=>{return t=e.id,void x((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]));var t},className:"mr-2"}),(0,o.jsx)("label",{htmlFor:"user-".concat(e.id),children:e.name})]},e.id)))})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,o.jsx)("button",{onClick:a,className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),(0,o.jsx)("button",{onClick:()=>{l&&d?new Date(l)>new Date(d)?alert("Start date cannot be after end date."):n({startDate:l,endDate:d,userIds:u}):alert("Please select both start and end dates.")},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Export"})]})]})})},G=e=>{let{customers:t,packages:s}=e;const[n,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[b,f]=(0,r.useState)([]),[v,j]=(0,r.useState)({}),[w,k]=(0,r.useState)(!1),[N,C]=(0,r.useState)(""),[L,A]=(0,r.useState)("name"),[_,M]=(0,r.useState)("asc"),[P,S]=(0,r.useState)(1),[D,R]=(0,r.useState)(10),[B,I]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(n){const e=s.find((e=>e.id===n.package_id));c(e||null)}}),[n,s]),(0,r.useEffect)((()=>{t.length>0&&(async()=>{I(!0);try{const e=t.map((async e=>{try{var t;const s=(await x.A.get("/payments/customer/".concat(e.id))).data,a=new Set;let r=null,n=0;return s.forEach((e=>{if(e.payment_dates)try{JSON.parse(e.payment_dates).forEach((e=>a.add(e)))}catch(t){console.error("Failed to parse payment_dates:",t)}if(e.payment_date){const t=new Date(e.payment_date);(!r||t>r)&&(r=t)}e.amount&&(n+=e.amount)})),{customerId:e.id,last_payment_date:(null===(t=r)||void 0===t?void 0:t.toISOString())||null,paid_amount:n,paid_dates:Array.from(a)}}catch(s){return console.error("Failed to fetch payments for customer ".concat(e.id,":"),s),{customerId:e.id,last_payment_date:null,paid_amount:0,paid_dates:[]}}})),s=await Promise.all(e),a={};s.forEach((e=>{a[e.customerId]=e})),j(a)}catch(e){console.error("Failed to fetch payment info:",e)}finally{I(!1)}})()}),[t,g]);const E=e=>{switch(e){case"DAILY":return"Harian";case"WEEKLY":return"Mingguan";case"MONTHLY":return"Bulanan";default:return e}},F=(0,r.useMemo)((()=>{let e=t.filter((e=>{const t=s.find((t=>t.id===e.package_id)),a=N.toLowerCase();return e.name.toLowerCase().includes(a)||(null===t||void 0===t?void 0:t.name.toLowerCase().includes(a))||!1}));return e.sort(((e,t)=>{var a,r,n,l;let o,i;switch(L){case"name":default:o=e.name.toLowerCase(),i=t.name.toLowerCase();break;case"package":const d=s.find((t=>t.id===e.package_id)),c=s.find((e=>e.id===t.package_id));o=(null===d||void 0===d?void 0:d.name.toLowerCase())||"",i=(null===c||void 0===c?void 0:c.name.toLowerCase())||"";break;case"lastPayment":o=(null===(a=v[e.id])||void 0===a?void 0:a.last_payment_date)||"",i=(null===(r=v[t.id])||void 0===r?void 0:r.last_payment_date)||"";break;case"paidAmount":o=(null===(n=v[e.id])||void 0===n?void 0:n.paid_amount)||0,i=(null===(l=v[t.id])||void 0===l?void 0:l.paid_amount)||0}return o<i?"asc"===_?-1:1:o>i?"asc"===_?1:-1:0})),e}),[t,s,v,N,L,_]),W=Math.ceil(F.length/D),T=F.slice((P-1)*D,P*D);(0,r.useEffect)((()=>{S(1)}),[N,L,_]);const z=e=>{L===e?M("asc"===_?"desc":"asc"):(A(e),M("asc"))},H=e=>{if(!e)return"-";return new Date(e).toLocaleDateString()},O=e=>{let{field:t}=e;return L!==t?(0,o.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})}):"asc"===_?(0,o.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):(0,o.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})};return(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Payment Confirmation"}),(0,o.jsx)("button",{onClick:()=>p(!0),disabled:B||0===t.length,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200 ml-2",children:B?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Exporting..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export All"]})}),(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[(0,o.jsx)("div",{className:"flex-1",children:(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,o.jsx)("input",{type:"text",placeholder:"Search customers or packages...",value:N,onChange:e=>C(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("label",{className:"text-sm text-gray-600 whitespace-nowrap",children:"Items per page:"}),(0,o.jsxs)("select",{value:D,onChange:e=>R(Number(e.target.value)),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,o.jsx)("option",{value:5,children:"5"}),(0,o.jsx)("option",{value:10,children:"10"}),(0,o.jsx)("option",{value:20,children:"20"}),(0,o.jsx)("option",{value:50,children:"50"})]})]})]}),(0,o.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[(0,o.jsxs)("span",{children:["Showing"," ",T.length>0?(P-1)*D+1:0," ","to"," ",T.length>0?Math.min(P*D,F.length):0," ","of ",F.length," entries",N&&" (filtered from ".concat(t.length," total entries)")]}),B&&(0,o.jsx)("span",{className:"text-blue-600",children:"Loading payment info..."})]})]}),(0,o.jsx)("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none",onClick:()=>z("name"),children:(0,o.jsxs)("div",{className:"flex items-center gap-1",children:["Customer Name",(0,o.jsx)(O,{field:"name"})]})}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none",onClick:()=>z("package"),children:(0,o.jsxs)("div",{className:"flex items-center gap-1",children:["Package",(0,o.jsx)(O,{field:"package"})]})}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none",onClick:()=>z("lastPayment"),children:(0,o.jsxs)("div",{className:"flex items-center gap-1",children:["Last Payment Date",(0,o.jsx)(O,{field:"lastPayment"})]})}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none",onClick:()=>z("paidAmount"),children:(0,o.jsxs)("div",{className:"flex items-center gap-1",children:["Paid Amount",(0,o.jsx)(O,{field:"paidAmount"})]})}),(0,o.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===T.length?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:B?(0,o.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Loading..."]}):N?'No customers found matching "'.concat(N,'"'):"No customers available"})}):T.map((e=>{const t=s.find((t=>t.id===e.package_id)),r=v[e.id],n=(null===r||void 0===r?void 0:r.paid_amount)&&r.paid_amount>0;return(0,o.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm mr-3",children:e.name.charAt(0).toUpperCase()}),(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})]})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-900",children:t?(0,o.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t.name}):(0,o.jsx)("span",{className:"text-gray-400",children:"No package"})})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm ".concat(n?"text-green-600 font-semibold":"text-gray-500"),children:H(null===r||void 0===r?void 0:r.last_payment_date)||"-"})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:null!==r&&void 0!==r&&r.paid_amount?(0,o.jsxs)("span",{className:"text-green-600",children:["Rp ",r.paid_amount.toLocaleString()]}):(0,o.jsx)("span",{className:"text-gray-400",children:"-"})})}),(0,o.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,o.jsxs)("button",{onClick:()=>(async e=>{const t=v[e.id];t?(f(t.paid_dates),i((0,a.A)((0,a.A)({},e),{},{paid_dates:t.paid_dates}))):(f([]),i((0,a.A)((0,a.A)({},e),{},{paid_dates:[]}))),u(!0)})(e),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200",children:[(0,o.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Confirm"]}),(0,o.jsxs)("button",{onClick:()=>(async e=>{try{var t;k(!0);const a=(await x.A.get("/payments/history/".concat(e.id))).data||[],r=s.find((t=>t.id===e.package_id)),n=[["RIWAYAT PEMBAYARAN"],[""],["Nama Pelanggan:",e.name],["Paket:",(null===r||void 0===r?void 0:r.name)||"Tidak diketahui"],["Metode Pembayaran:",E(null===r||void 0===r?void 0:r.payment_method)],["Tarif:","Rp ".concat((null===r||void 0===r||null===(t=r.payment_amount)||void 0===t?void 0:t.toLocaleString("id-ID"))||0)],["Tanggal Mulai Paket:",e.package_start_date?(0,l.A)(new Date(e.package_start_date),"dd MMMM yyyy",{locale:V.A}):"Tidak diketahui"],[""],["DAFTAR TANGGAL KONFIRMASI:"],["Tanggal","Status","Jumlah Pembayaran","Tanggal Pembayaran"]];a.forEach((e=>{let t=[];try{t=e.payment_dates?JSON.parse(e.payment_dates):[]}catch(a){console.error("Error parsing payment dates:",a)}var s;t.length>0?t.forEach((t=>{var s;n.push([(0,l.A)(new Date(t),"dd MMMM yyyy",{locale:V.A}),e.status||"-","Rp ".concat((null===(s=e.amount)||void 0===s?void 0:s.toLocaleString("id-ID"))||0),e.payment_date?(0,l.A)(new Date(e.payment_date),"dd MMMM yyyy",{locale:V.A}):"-"])})):n.push(["-",e.status||"-","Rp ".concat((null===(s=e.amount)||void 0===s?void 0:s.toLocaleString("id-ID"))||0),e.payment_date?(0,l.A)(new Date(e.payment_date),"dd MMMM yyyy",{locale:V.A}):"-"])}));const o=Y.Wp.book_new(),i=Y.Wp.aoa_to_sheet(n);Y.Wp.book_append_sheet(o,i,"Riwayat Pembayaran");const d="Riwayat_Pembayaran_".concat(e.name.replace(/\s+/g,"_"),"_").concat((0,l.A)(new Date,"ddMMyyyy"),".xlsx");Y._h(o,d)}catch(a){console.error("Export failed:",a),alert("Gagal mengekspor data. Silakan coba lagi.")}finally{k(!1)}})(e),disabled:w,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 ml-2",children:[(0,o.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export"]})]})]},e.id)}))})]})}),W>1&&(0,o.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("button",{onClick:()=>S(1),disabled:1===P,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"First"}),(0,o.jsx)("button",{onClick:()=>S(P-1),disabled:1===P,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"})]}),(0,o.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,W)},((e,t)=>{let s;return s=W<=5||P<=3?t+1:P>=W-2?W-4+t:P-2+t,(0,o.jsx)("button",{onClick:()=>S(s),className:"px-3 py-2 text-sm border rounded-md ".concat(P===s?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-50"),children:s},s)}))}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("button",{onClick:()=>S(P+1),disabled:P===W,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}),(0,o.jsx)("button",{onClick:()=>S(W),disabled:P===W,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Last"})]})]}),m&&n&&d&&(0,o.jsx)(U,{customer:n?(0,a.A)((0,a.A)({},n),{},{paid_dates:b}):null,packages:s,onClose:()=>{u(!1),i(null),c(null)},onSubmit:async e=>{if(n)try{const t={customerId:n.id,packageId:null===d||void 0===d?void 0:d.id,amount:e.amount,paymentDate:e.paymentDate,selectedDates:e.selectedDates,paymentMethod:(null===d||void 0===d?void 0:d.payment_method)||"DAILY"},s=await x.A.post("/payments",t);alert(s.data.message),u(!1),y(!g)}catch(t){alert("Failed to confirm payment: "+t.message)}}}),h&&(0,o.jsx)(q,{customers:t,isOpen:h,onClose:()=>p(!1),onConfirm:e=>{p(!1),(async e=>{try{I(!0);const s=Y.Wp.book_new(),a=[["LAPORAN PEMBAYARAN PELANGGAN"],["Tanggal Export",(new Date).toLocaleDateString("id-ID")],["Total Pelanggan",0],[""],["DAFTAR PELANGGAN"],["No","Nama Pelanggan","Paket","Metode Pembayaran","Tarif","Tanggal Mulai Paket","Total Pembayaran","Terakhir Bayar"]],r=new URLSearchParams;var t;e&&(e.startDate&&r.append("startDate",e.startDate),e.endDate&&r.append("endDate",e.endDate),(null===(t=e.userIds)||void 0===t?void 0:t.length)>0&&r.append("userIds",e.userIds.join(",")));const n=(await x.A.get("/payments/export-all?".concat(r.toString()))).data||[];a[2][1]=n.length,n.forEach(((e,t)=>{const r=e.package,n=e.payments||[],o=n.reduce(((e,t)=>e+(t.amount||0)),0),i=n[0];a.push([t+1,e.customer_name||e.name,(null===r||void 0===r?void 0:r.name)||"-",r?E(r.payment_method):"-",null!==r&&void 0!==r&&r.payment_amount?"Rp ".concat(r.payment_amount.toLocaleString("id-ID")):"-",e.package_start_date?(0,l.A)(new Date(e.package_start_date),"dd/MM/yyyy"):"-","Rp ".concat(o.toLocaleString("id-ID")),null!==i&&void 0!==i&&i.payment_date?(0,l.A)(new Date(i.payment_date),"dd/MM/yyyy"):"-"]);const d=[["Detail Pembayaran: ".concat(e.customer_name||e.name)],["Paket",(null===r||void 0===r?void 0:r.name)||"-"],["Metode Pembayaran",r?E(r.payment_method):"-"],["Tarif",null!==r&&void 0!==r&&r.payment_amount?"Rp ".concat(r.payment_amount.toLocaleString("id-ID")):"-"],["Tanggal Mulai Paket",e.package_start_date?(0,l.A)(new Date(e.package_start_date),"dd/MM/yyyy"):"-"],[""],["RIWAYAT PEMBAYARAN"],["Tanggal","Jumlah","Status","Tanggal Pembayaran"]];n.forEach((e=>{let t=[];try{e.payment_dates&&(t="string"===typeof e.payment_dates?JSON.parse(e.payment_dates):e.payment_dates,Array.isArray(t)||(t=[]))}catch(a){console.error("Error parsing payment dates:",a),t=[]}var s;t.length>0?t.forEach((t=>{var s;d.push([(0,l.A)(new Date(t),"dd/MM/yyyy"),"Rp ".concat((null===(s=e.amount)||void 0===s?void 0:s.toLocaleString("id-ID"))||0),e.status||"-",e.payment_date?(0,l.A)(new Date(e.payment_date),"dd/MM/yyyy"):"-"])})):d.push(["-","Rp ".concat((null===(s=e.amount)||void 0===s?void 0:s.toLocaleString("id-ID"))||0),e.status||"-",e.payment_date?(0,l.A)(new Date(e.payment_date),"dd/MM/yyyy"):"-"])}));const c=Y.Wp.aoa_to_sheet(d);Y.Wp.book_append_sheet(s,c,"Pelanggan ".concat(t+1).substring(0,31))}));const o=Y.Wp.aoa_to_sheet(a);Y.Wp.book_append_sheet(s,o,"Ringkasan");const i="Laporan_Pembayaran_".concat((0,l.A)(new Date,"yyyyMMdd"),".xlsx");Y._h(s,i)}catch(s){console.error("Export failed:",s),alert("Gagal mengekspor data. Silakan coba lagi.")}finally{I(!1)}})(e)}})]})};const K=function(){const[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)([]),[p,g]=(0,r.useState)([]),[y,b]=(0,r.useState)([]),[f,v]=(0,r.useState)(null),[j,w]=(0,r.useState)(null),[k,N]=(0,r.useState)(new Date),[C,A]=(0,r.useState)(1),[_,M]=(0,r.useState)((()=>localStorage.getItem("adminActiveTab")||"products")),[P,S]=(0,r.useState)(!1),[D,R]=(0,r.useState)(""),[B,E]=(0,r.useState)("name"),[F,W]=(0,r.useState)([]),[T,z]=(0,r.useState)(1),[H,O]=(0,r.useState)(null),[V,Y]=(0,r.useState)(null),[U,q]=(0,r.useState)(null),[K,J]=(0,r.useState)(!1),[X,Z]=(0,r.useState)(!1),Q=(0,n.Zp)(),$=((0,r.useRef)(null),5*T),[ee,te]=(F.slice(0,$),(0,r.useState)({name:"",price:0,description:""})),[se,ae]=(p.filter((e=>e.name.toLowerCase().includes(D.toLowerCase()))),(0,r.useState)({name:"",description:"",payment_method:"daily",payment_amount:0,payment_months:0,productIds:[]}));(0,r.useEffect)((()=>{localStorage.setItem("adminActiveTab",_)}),[_]),(0,r.useEffect)((()=>{re()}),[]),(0,r.useEffect)((()=>{oe(),le()}),[]);const re=async()=>{S(!0),O(null);try{await ne(),console.log("Fetching data from all endpoints...");const e=[{name:"packages",url:"/packages"},{name:"products",url:"/products"},{name:"customers",url:"/users/customers"},{name:"resellers",url:"/users/resellers"}],s=await Promise.allSettled(e.map((e=>x.A.get(e.url))));let a=!1,r=[];const n=s[0];"fulfilled"===n.status?(console.log("Packages loaded:",n.value.data),t(n.value.data)):(console.error("Failed to load packages:",n.reason),a=!0,r.push("Error fetching packages: ".concat(n.reason.message)));const l=s[1];"fulfilled"===l.status?(console.log("Products loaded:",l.value.data),g(l.value.data)):(console.error("Failed to load products:",l.reason),a=!0,r.push("Error fetching products: ".concat(l.reason.message)));const o=s[2];"fulfilled"===o.status?(console.log("Customers loaded:",o.value.data),c(o.value.data)):(console.error("Failed to load customers:",o.reason),a=!0,r.push("Error fetching customers: ".concat(o.reason.message)));const i=s[3];"fulfilled"===i.status?(console.log("Resellers loaded:",i.value.data),b(i.value.data)):(console.error("Failed to load resellers:",i.reason),a=!0,r.push("Error fetching resellers: ".concat(i.reason.message))),a&&O(r.join(". "))}catch(e){console.error("Data fetch error:",e),O("Connection error: ".concat(e.message,". Please check if the backend server is running."))}finally{S(!1)}},ne=async()=>{try{if(!(await fetch("http://localhost:3001/api/health-check")).ok)throw new Error("Backend not healthy");return!0}catch(H){throw console.error("Backend check failed:",H),new Error("Backend tidak dapat dihubungi. Silakan coba lagi nanti.")}},le=async()=>{S(!0);try{const e=await x.A.get("/products");console.log("Products data:",e.data),g(e.data)}catch(e){console.error("Error fetching products:",e),O("Failed to load products: "+e.message)}finally{S(!1)}},oe=async()=>{S(!0);try{console.log("Fetching packages...");const e=await x.A.get("/packages");if(console.log("Packages data:",e.data),!Array.isArray(e.data))throw new Error("Invalid packages data format");return t(e.data),e.data}catch(H){var e,s;console.error("Package fetch error:",H),O("Failed to load packages: "+((null===(e=H.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||H.message))}finally{S(!1)}},ie=e=>{const{name:t,value:s}=e.target;te((e=>(0,a.A)((0,a.A)({},e),{},{[t]:"price"===t?parseFloat(s)||0:s})))},de=async()=>{J(!0);try{const e=await x.A.post("/products",ee);return te({name:"",price:0,description:""}),await le(),e.data}catch(e){throw console.error("Failed to create product",e),O("Failed to create product: "+e.message),e}finally{J(!1)}},ce=async e=>{S(!0),O(null);try{await x.A.put("/products/".concat(e.id),e),await le()}catch(t){throw console.error("Failed to update product",t),O("Failed to update product: "+t.message),t}finally{S(!1)}},me=async e=>{S(!0),O(null);try{await x.A.delete("/products/".concat(e)),await le()}catch(t){console.error("Failed to delete product",t),O("Failed to delete product: "+t.message)}finally{S(!1)}},ue=e=>{const{name:t,value:s}=e.target;ae((e=>(0,a.A)((0,a.A)({},e),{},{[t]:"payment_amount"===t?parseFloat(s)||0:s})))},xe=e=>{ae((t=>{const s=t.productIds.includes(e)?t.productIds.filter((t=>t!==e)):[...t.productIds,e],r=p.filter((e=>s.includes(e.id))).reduce(((e,t)=>e+t.price),0);return(0,a.A)((0,a.A)({},t),{},{productIds:s,payment_amount:r})}))},he=async()=>{J(!0);try{const e=await x.A.post("/packages",{name:se.name,description:se.description,payment_method:se.payment_method.toUpperCase(),payment_amount:parseFloat(se.payment_amount),payment_months:parseInt(se.payment_months),productIds:se.productIds});console.log("Package created:",e.data),alert("Package created successfully!"),ae({name:"",description:"",payment_method:"daily",payment_amount:0,payment_months:0,productIds:[]}),await oe()}catch(H){var e,t,s,a;console.error("Error creating package:",H),O("Failed to create package: ".concat((null===(e=H.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||H.message)),alert("Failed: ".concat((null===(s=H.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||H.message))}finally{J(!1)}},pe=async e=>{S(!0),O(null);try{if(!e.username)throw new Error("Username is required");const t=await x.A.post("/users/resellers",e);return b((e=>[...e,t.data])),t.data}catch(a){var t,s;throw console.error("Failed to create reseller",a),O((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to create reseller"),a}finally{S(!1)}},ge=async(e,t)=>{S(!0),O(null);try{const s=await x.A.put("/users/resellers/".concat(e),t);b((t=>t.map((t=>t.id===e?s.data:t))))}catch(s){console.error("Failed to update reseller",s),O("Failed to update reseller: "+s.message)}finally{S(!1)}},ye=async e=>{try{const t=await x.A.put("/packages/".concat(e.id),(0,a.A)((0,a.A)({},e),{},{productIds:e.productIds}));return await oe(),t.data}catch(H){throw H}},be=async e=>{S(!0),O(null);try{await x.A.delete("/users/resellers/".concat(e)),b((t=>t.filter((t=>t.id!==e))))}catch(t){console.error("Failed to delete reseller",t),O("Failed to delete reseller: "+t.message)}finally{S(!1)}},fe=async e=>{S(!0),O(null);try{await x.A.put("/packages/".concat(e.id),{name:e.name,description:e.description,payment_method:e.payment_method.toUpperCase(),payment_amount:parseFloat(e.payment_amount),payment_months:e.payment_months,productIds:e.productIds}),await oe()}catch(t){throw console.error("Failed to update package",t),O("Failed to update package: "+t.message),t}finally{S(!1)}},ve=async(e,t)=>{try{const s=await x.A.put("/products/".concat(e),t);return await oe(),s.data}catch(H){throw H}},je=async e=>{S(!0),O(null);try{await x.A.delete("/packages/".concat(e)),await oe()}catch(r){var t,s,a;console.error("Delete error details:",(null===(t=r.response)||void 0===t?void 0:t.data)||r.message),O((null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to delete package. It may still contain products.")}finally{S(!1)}},we=async e=>{if(f&&j){S(!0);try{const t=e.map((e=>({user_id:f.id,package_id:j.id,payment_date:new Date(e).toISOString(),amount:j.payment_amount,status:"confirmed",payment_start_date:k.toISOString(),payment_months:paymentmonths})));await x.A.post("/payments/bulk",{payments:t}),alert("Payments confirmed successfully!"),await re()}catch(t){console.error("Failed to confirm payment",t),O("Failed to confirm payments: "+t.message),alert("Failed to confirm payments: "+t.message)}finally{S(!1)}}else alert("Please select both customer and package to confirm payment.")},ke=e=>{Y(e),Q("/admin/products/".concat(e.id))},Ne=async(e,t)=>{S(!0),O(null);try{const s=await x.A.post("/resellers/".concat(e,"/customers"),t);c((e=>[...e,s.data]))}catch(s){console.error("Failed to add customer",s),O("Failed to add customer: "+s.message)}finally{S(!1)}},Ce=async(e,t)=>{S(!0),O(null);try{const s=await x.A.put("/customers/".concat(e),t);c((t=>t.map((t=>t.id===e?s.data:t))))}catch(s){console.error("Failed to update customer",s),O("Failed to update customer: "+s.message)}finally{S(!1)}},Le=async e=>{S(!0),O(null);try{await x.A.delete("/customers/".concat(e)),c((t=>t.filter((t=>t.id!==e))))}catch(t){console.error("Failed to delete customer",t),O("Failed to delete customer: "+t.message)}finally{S(!1)}},Ae=async(e,t)=>{S(!0),O(null);try{const s=await x.A.put("/customers/".concat(e,"/package"),t);c((t=>t.map((t=>t.id===e?s.data:t))))}catch(s){console.error("Failed to update customer package",s),O("Failed to update customer package: "+s.message)}finally{S(!1)}},_e=async e=>{try{await x.A.post("/payments",e);c((t=>t.map((t=>t.id===e.customerId?(0,a.A)((0,a.A)({},t),{},{paid_amount:(t.paid_amount||0)+e.amount,paid_dates:[...t.paid_dates||[],...e.selectedDates],payment_history:[...t.payment_history||[],{date:(0,l.A)(new Date(e.paymentDate)),amount:e.amount,dates:e.selectedDates}]}):t)))),toast.success("Payment confirmed successfully")}catch(H){console.error("Payment failed:",H),toast.error("Payment failed: ".concat(H.message))}},Me=()=>se.productIds.reduce(((e,t)=>{const s=p.find((e=>e.id===t));return e+((null===s||void 0===s?void 0:s.price)||0)}),0);return(0,o.jsxs)(i,{activeTab:_,setActiveTab:M,children:[H&&(0,o.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded",children:[(0,o.jsx)("p",{className:"font-bold",children:"Error"}),(0,o.jsx)("p",{children:H}),(0,o.jsx)("button",{className:"mt-2 bg-red-200 hover:bg-red-300 text-red-800 font-bold py-1 px-3 rounded",onClick:()=>re(),children:"Refresh Data"})]}),P&&(0,o.jsxs)("div",{className:"bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 mb-6 rounded",children:[(0,o.jsx)("p",{className:"font-bold",children:"Loading..."}),(0,o.jsx)("p",{children:"Please wait while we fetch the data."})]}),(()=>{switch(_){case"products":return(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,o.jsx)(d,{newProduct:ee,handleProductChange:ie,createProduct:de,isLoading:K}),(0,o.jsx)(m,{products:p,onProductSelect:ke,selectedProductId:null===V||void 0===V?void 0:V.id,isLoading:P,onRefresh:le,error:H,onEdit:ce,onDelete:me})]});case"packages":return(0,o.jsxs)("div",{className:"w-full grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,o.jsx)(u,{newPackage:se,products:p,handlePackageChange:ue,toggleProductInPackage:xe,calculatePackageTotal:Me,createPackage:he,isLoading:K}),(0,o.jsx)(h,{packages:e,products:p,isLoading:P,error:H,onRefresh:oe,onEdit:fe,onEditProduct:ve,onEditPackage:ye,onDelete:je})]});case"customers":return(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Akun Customer Management"}),(0,o.jsx)(L,{customers:s,packages:e,onSelectCustomer:v,isLoading:P,error:H,onRefresh:()=>re()})]});case"resellers":return(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Reseller Management"}),(0,o.jsx)(I,{resellers:y,customers:s,packages:e,onCreateReseller:pe,onUpdateReseller:ge,onDeleteReseller:be,onAddCustomer:Ne,onUpdateCustomer:Ce,onDeleteCustomer:Le,onUpdateCustomerPackage:Ae,isLoading:P,error:H,onRefresh:()=>re()})]});case"confirmations":return(0,o.jsx)(G,{customers:s,packages:e,selectedCustomer:f,setSelectedCustomer:v,selectedPackage:j,setSelectedPackage:w,paymentStartDate:k,setPaymentStartDate:N,paymentMonths:C,setPaymentMonths:A,onConfirm:we,isLoading:P,error:H,onClose:()=>Z(!1),onSubmit:_e});default:return null}})()]})}}}]);
//# sourceMappingURL=654.6a0794a0.chunk.js.map