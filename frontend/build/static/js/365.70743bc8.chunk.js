"use strict";(self.webpackChunkramadhan_package_frontend=self.webpackChunkramadhan_package_frontend||[]).push([[365],{365:(e,a,t)=>{t.r(a),t.d(a,{default:()=>g});var n=t(43),s=t(722),i=t(265),l=t(819),r=t(355),d=t(260),o=t(666);var c=t(10),m=t(579);const g=function(){const[e,a]=(0,n.useState)([]),[t,g]=(0,n.useState)(null),[h,u]=(0,n.useState)(new Date),[p,y]=(0,n.useState)(1),[x,b]=(0,n.useState)([]),[f,j]=(0,n.useState)(0);(0,n.useEffect)((()=>{N()}),[]),(0,n.useEffect)((()=>{t&&v()}),[x,t]);const N=async()=>{try{const e=await s.A.get("http://localhost:3001/api/packages");a(e.data)}catch(e){console.error("Failed to fetch packages",e)}},k=(e,a)=>{switch(a){case"daily":default:return e;case"weekly":return e/7;case"monthly":return e/30}},v=()=>{if(!t)return 0;const e=k(t.payment_amount,t.payment_method),a=x.length*e;j(a)};return(0,m.jsxs)("div",{className:"p-4 max-w-5xl mx-auto bg-gray-50 min-h-screen",children:[(0,m.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center text-gray-800",children:"Panel Pelanggan"}),(0,m.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,m.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Pilih Paket"}),0===e.length?(0,m.jsx)("p",{className:"text-gray-600",children:"Tidak ada paket tersedia."}):(0,m.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map((e=>(0,m.jsxs)("div",{onClick:()=>(e=>{g(e),b([]),u(new Date),y(1)})(e),className:"p-4 border rounded-lg cursor-pointer transition-all ".concat((null===t||void 0===t?void 0:t.id)===e.id?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-indigo-300"),children:[(0,m.jsx)("h3",{className:"font-bold text-lg text-gray-800",children:e.name}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),(0,m.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,m.jsxs)("span",{className:"font-semibold text-indigo-600",children:["Rp ",e.payment_amount.toLocaleString("id-ID")]}),(0,m.jsx)("span",{className:"text-xs px-2 py-1 bg-gray-100 rounded-full",children:"daily"===e.payment_method?"Harian":"weekly"===e.payment_method?"Mingguan":"Bulanan"})]})]},e.id)))})]}),t&&(0,m.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,m.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Konfirmasi Pembayaran"}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsxs)("h3",{className:"font-medium mb-2",children:["Paket Terpilih: ",t.name]}),(0,m.jsxs)("p",{className:"text-gray-600 mb-1",children:["Metode Pembayaran:"," ","daily"===t.payment_method?"Harian":"weekly"===t.payment_method?"Mingguan":"Bulanan"]}),(0,m.jsxs)("p",{className:"text-gray-600",children:["Harga Paket: Rp"," ",t.payment_amount.toLocaleString("id-ID")]})]}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("label",{className:"block font-medium mb-2",children:"Mulai Tanggal:"}),(0,m.jsx)("input",{type:"date",value:(0,i.A)(h,"yyyy-MM-dd"),onChange:e=>u(new Date(e.target.value)),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsxs)("label",{className:"block font-medium mb-2",children:["Durasi (","daily"===t.payment_method?"Hari":"weekly"===t.payment_method?"Minggu":"Bulan","):"]}),(0,m.jsx)("input",{type:"number",min:"1",max:"monthly"===t.payment_method?"12":"31",value:p,onChange:e=>y(parseInt(e.target.value)||1),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(()=>{if(!t)return null;const e="monthly"===t.payment_method?(0,l.A)(h,p):function(e,a){(0,o.A)(2,arguments);var t=(0,d.A)(e),n=(0,r.A)(a);return isNaN(n)?new Date(NaN):n?(t.setDate(t.getDate()+n),t):t}(h,p*("weekly"===t.payment_method?7:30)),a=(0,c.A)({start:h,end:e});return(0,m.jsxs)("div",{className:"mt-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Pilih Tanggal Pembayaran:"}),(0,m.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-4",children:["M","S","S","R","K","J","S"].map((e=>(0,m.jsx)("div",{className:"text-center font-semibold text-sm py-1",children:e},e)))}),(0,m.jsx)("div",{className:"grid grid-cols-7 gap-1",children:a.map((e=>{const a=(0,i.A)(e,"yyyy-MM-dd"),t=x.includes(a),n=e.getMonth()===h.getMonth();return(0,m.jsx)("button",{onClick:()=>(e=>{const a=(0,i.A)(e,"yyyy-MM-dd");b((e=>e.includes(a)?e.filter((e=>e!==a)):[...e,a]))})(e),className:"p-2 rounded-full text-sm ".concat(t?"bg-indigo-600 text-white":n?"bg-white text-gray-800":"bg-gray-100 text-gray-400"," ").concat(n?"hover:bg-indigo-100":""),disabled:!n,children:(0,i.A)(e,"d")},a)}))})]})})(),x.length>0&&(0,m.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,m.jsx)("h3",{className:"font-semibold mb-2",children:"Rincian Pembayaran:"}),(0,m.jsxs)("p",{children:["Jumlah Hari: ",x.length]}),(0,m.jsxs)("p",{children:["Harga per Hari: Rp"," ",k(t.payment_amount,t.payment_method).toLocaleString("id-ID")]}),(0,m.jsxs)("p",{className:"font-bold mt-2",children:["Total Pembayaran: Rp ",f.toLocaleString("id-ID")]})]}),(0,m.jsx)("button",{onClick:async()=>{if(0===x.length)return void alert("Pilih setidaknya satu tanggal pembayaran");const e={customerId:1,packageId:t.id,amount:f,paymentDate:(new Date).toISOString(),selectedDates:x,paymentMethod:t.payment_method};try{const a=await s.A.post("http://localhost:3001/api/payments",e);alert(a.data.message)}catch(a){a.response&&a.response.data?alert("Gagal konfirmasi pembayaran: ".concat(a.response.data.error,"\n")+(a.response.data.duplicateDates?"Tanggal duplikat: ".concat(a.response.data.duplicateDates.join(", ")):"")):alert("Gagal konfirmasi pembayaran: "+a.message)}},className:"mt-6 w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Konfirmasi Pembayaran"})]})]})}}}]);
//# sourceMappingURL=365.70743bc8.chunk.js.map